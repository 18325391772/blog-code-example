{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?5b85","webpack:///./src/App.vue?19bd","webpack:///./src/components/Sidebar.vue?c838","webpack:///src/components/Sidebar.vue","webpack:///./src/components/Sidebar.vue?7ef4","webpack:///./src/components/Sidebar.vue","webpack:///./src/components/Information.vue?f9d8","webpack:///src/components/Information.vue","webpack:///./src/components/Information.vue?6735","webpack:///./src/components/Information.vue","webpack:///./src/components/DebugPanel.vue?fd24","webpack:///src/components/DebugPanel.vue","webpack:///./src/components/DebugPanel.vue?4920","webpack:///./src/components/DebugPanel.vue","webpack:///./src/compass/Variables.js","webpack:///./src/compass/PaintObj.js","webpack:///./src/compass/Coord.js","webpack:///./src/compass/Scene.js","webpack:///./src/compass/SensorPoint.js","webpack:///./src/compass/Craft.js","webpack:///./src/compass/Sphere.js","webpack:///./src/compass/SpacePath.js","webpack:///./src/assets/SPVertexCode.vsh","webpack:///./src/assets/SPFragCode.fsh","webpack:///src/App.vue","webpack:///./src/App.vue?a7d1","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","index","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_2bb3bc52_render","_vm","this","_h","$createElement","_c","_self","attrs","fluid","id","cols","camera","ref","width","height","on","valueChanged","$event","debugValueChanged","staticRenderFns","Sidebarvue_type_template_id_9029acaa_render","staticClass","_v","type","min","max","change","cameraThetaChanged","model","callback","$$v","cameraTheta","expression","cameraPhiChanged","cameraPhi","cameraDisChanged","cameraDis","_m","Sidebarvue_type_template_id_9029acaa_staticRenderFns","Sidebarvue_type_script_lang_js_","props","methods","rotate","components_Sidebarvue_type_script_lang_js_","component","componentNormalizer","Sidebar","Informationvue_type_template_id_7f9ab7d8_render","Informationvue_type_template_id_7f9ab7d8_staticRenderFns","Informationvue_type_script_lang_js_","components_Informationvue_type_script_lang_js_","Information_component","Information","DebugPanelvue_type_template_id_7a4552b7_render","$emit","heading","pitch","roll","DebugPanelvue_type_template_id_7a4552b7_staticRenderFns","DebugPanelvue_type_script_lang_js_","components_DebugPanelvue_type_script_lang_js_","DebugPanel_component","DebugPanel","states","gl","attributes","uniforms","PaintObj","classCallCheck","undefined","sides","alpha","color","size","buffers","mMatrix","mat4","pvMatrix","mvpMatrix","quat","vscale","vec3","fromValues","translation","visible","_x","_y","_z","_rotateX","_rotateY","_rotateZ","drawtype","buffer","createBuffer","ELEMENT_ARRAY_BUFFER","itemSize","Float32Array","ARRAY_BUFFER","numItems","bindBuffer","bufferData","offset","bufferSubData","cylinderShape","radius","segment","bottom","circleShape","upper","Math","PI","vertex","concat","thetaStart","thetaEnd","pos","x","y","z","start","end","dtheta","cos","sin","rotateVertex","theta","beta","dis","v","set","rotateY","rotateZ","degToRad","deg","genVertices","normal","vertices","coordCarte","phi","st","ct","sp","cp","Coord","_this","possibleConstructorReturn","getPrototypeOf","init","xcoord","xvertices","ycoord","yvertices","zcoord","zvertices","createArrayBuffer","STATIC_DRAW","Uint16Array","uniform1f","uniformMatrix4fv","m_matrix","pmv_matrix","vertexAttribPointer","vertex_position","FLOAT","vertex_normal","drawElements","TRIANGLES","UNSIGNED_SHORT","matrix","mul","Camera","defaultTheta","defaultPhi","defaultDis","defaultViewWidth","defaultViewHeight","up","lookat","pMatrix","vMatrix","setSize","lookAt","watcher","a_theta","a_phi","update","viewport","perspective","Scene","enable","DEPTH_TEST","depthFunc","LESS","CULL_FACE","cullFace","BACK","clearColor","clearDepth","pixelStorei","UNPACK_FLIP_Y_WEBGL","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","objs","light_direct","obj","first","unshift","console","log","recv","onViewChanged","running","scope","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","paint","requestAnimationFrame","codestr","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexCode","fragCode","shaderProgram","createProgram","vertexShader","getShader","VERTEX_SHADER","attachShader","fragShader","FRAGMENT_SHADER","_onShaderReady","linkProgram","useProgram","getAttribLocation","enableVertexAttribArray","texture","getUniformLocation","n_matrix","frag_color","has_texture","light_direction","specColor","vertexColor","uniform3fv","SensorPoint","inv_color","headingOffset","callbacks","cylinder","index_count","fromEuler","params","setTranslation","fromRotationTranslationScale","spherical","cb","u","setParam","SensorPath","_this2","MaxPathNum","all_index_count","cur_path_count","cur_index_count","cur_pi","buffer_path_bytes","buffer_index_bytes","gap","pg","angle","last_point","path","nangle","langle","presult","getLinearPoint","subBuffer","resetCurrentPath","lp","s1","s2","n0","cross","normalize","scale","that","pushVertex","seg","lpos","dist","updateBuffer","vec","args","deleteBuffer","DYNAMIC_DRAW","RecordPoint","_this3","max_vertex","vertex_count","point","Craft","url","setScale","readFile","text","mesh","ObjLoader","OBJ","Mesh","initMeshBuffers","uniform1i","vertexBuffer","normalBuffer","indexBuffer","fromScaling","rotateX","sensorPoint","Sphere","vn","hn","ratio","drawMode","MODE_SURFACE","line_alpha","res","getVertex","getIndex","vertex_index","lineIndexBuffer","line_index","lessLineIndexBuffer","less_line_index","lessLSIndexBuffer","less_ls_index","MODE_LINE","LINES","MODE_LESSLINE","k","vertexIndex","lineIndex","lessLineIndex","lessLSIndex","RefCircle","circles","green","blue","ReferCircle","initSize","isCurrent","setQuat","current","a_beta","abs","originColor","LINE_LOOP","SPVertexCode","SPFragCode","SpacePath","canvas","getContext","depth","antilias","scene","initShaders","addCamera","coord","add","sensorPath","sphere","recordPoint","refCircle","addParamCallback","onSphericalChanged","render","createClass","reset","resetAllPath","craft","setRotation","coordinate","Ball","pixelRatio","devicePixelRatio","currentWidth","currentHeight","pixelSize","Qt","Appvue_type_script_lang_js_","components","CSidebar","CInformation","CDebugPanel","created","mounted","spacepath","SpacePath_SpacePath","$refs","event","parse_float_default","src_Appvue_type_script_lang_js_","App_component","App","Vue","use","BootstrapVue","config","productionTip","h","$mount"],"mappings":"aACA,SAAAA,EAAAC,GAQA,IAPA,IAMAC,EAAAC,EANAC,EAAAH,EAAA,GACAI,EAAAJ,EAAA,GACAK,EAAAL,EAAA,GAIAM,EAAA,EAAAC,EAAA,GACQD,EAAAH,EAAAK,OAAoBF,IAC5BJ,EAAAC,EAAAG,GACAG,EAAAP,IACAK,EAAAG,KAAAD,EAAAP,GAAA,IAEAO,EAAAP,GAAA,EAEA,IAAAD,KAAAG,EACAO,OAAAC,UAAAC,eAAAC,KAAAV,EAAAH,KACAc,EAAAd,GAAAG,EAAAH,IAGAe,KAAAhB,GAEA,MAAAO,EAAAC,OACAD,EAAAU,OAAAV,GAOA,OAHAW,EAAAR,KAAAS,MAAAD,EAAAb,GAAA,IAGAe,IAEA,SAAAA,IAEA,IADA,IAAAC,EACAf,EAAA,EAAiBA,EAAAY,EAAAV,OAA4BF,IAAA,CAG7C,IAFA,IAAAgB,EAAAJ,EAAAZ,GACAiB,GAAA,EACAC,EAAA,EAAkBA,EAAAF,EAAAd,OAA2BgB,IAAA,CAC7C,IAAAC,EAAAH,EAAAE,GACA,IAAAf,EAAAgB,KAAAF,GAAA,GAEAA,IACAL,EAAAQ,OAAApB,IAAA,GACAe,EAAAM,IAAAC,EAAAN,EAAA,KAGA,OAAAD,EAIA,IAAAQ,EAAA,GAKApB,EAAA,CACAqB,MAAA,GAGAZ,EAAA,GAGA,SAAAS,EAAA1B,GAGA,GAAA4B,EAAA5B,GACA,OAAA4B,EAAA5B,GAAA8B,QAGA,IAAAC,EAAAH,EAAA5B,GAAA,CACAK,EAAAL,EACAgC,GAAA,EACAF,QAAA,IAUA,OANAhB,EAAAd,GAAAa,KAAAkB,EAAAD,QAAAC,IAAAD,QAAAJ,GAGAK,EAAAC,GAAA,EAGAD,EAAAD,QAKAJ,EAAAO,EAAAnB,EAGAY,EAAAQ,EAAAN,EAGAF,EAAAS,EAAA,SAAAL,EAAAM,EAAAC,GACAX,EAAAY,EAAAR,EAAAM,IACA1B,OAAA6B,eAAAT,EAAAM,EAAA,CAA0CI,YAAA,EAAAC,IAAAJ,KAK1CX,EAAAgB,EAAA,SAAAZ,GACA,qBAAAa,eAAAC,aACAlC,OAAA6B,eAAAT,EAAAa,OAAAC,YAAA,CAAwDC,MAAA,WAExDnC,OAAA6B,eAAAT,EAAA,cAAiDe,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,kBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAvC,OAAAwC,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAvC,OAAA6B,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAS,EAAAc,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAAtB,GACA,IAAAM,EAAAN,KAAAiB,WACA,WAA2B,OAAAjB,EAAA,YAC3B,WAAiC,OAAAA,GAEjC,OADAL,EAAAS,EAAAE,EAAA,IAAAA,GACAA,GAIAX,EAAAY,EAAA,SAAAgB,EAAAC,GAAsD,OAAA7C,OAAAC,UAAAC,eAAAC,KAAAyC,EAAAC,IAGtD7B,EAAA8B,EAAA,IAEA,IAAAC,EAAAC,OAAA,gBAAAA,OAAA,oBACAC,EAAAF,EAAAhD,KAAA2C,KAAAK,GACAA,EAAAhD,KAAAX,EACA2D,IAAAG,QACA,QAAAvD,EAAA,EAAgBA,EAAAoD,EAAAlD,OAAuBF,IAAAP,EAAA2D,EAAApD,IACvC,IAAAU,EAAA4C,EAIA1C,EAAAR,KAAA,qBAEAU,kFCtJA,IAAA0C,EAAAnC,EAAA,QAAAoC,EAAApC,EAAA2B,EAAAQ,GAAqbC,EAAG,sGCApbC,EAAM,WAAgB,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,eAAyBE,MAAA,CAAOC,MAAA,GAAAC,GAAA,QAAuB,CAAAJ,EAAA,SAAAA,EAAA,SAA0BE,MAAA,CAAOG,KAAA,MAAY,CAAAL,EAAA,aAAkBE,MAAA,CAAOI,OAAAV,EAAAU,UAAqBN,EAAA,qBAAAA,EAAA,SAAsCE,MAAA,CAAOG,KAAA,OAAa,CAAAL,EAAA,UAAeO,IAAA,SAAAL,MAAA,CAAoBM,MAAA,MAAAC,OAAA,WAA8BT,EAAA,SAAgBE,MAAA,CAAOG,KAAA,MAAY,CAAAL,EAAA,iBAAsBU,GAAA,CAAIC,aAAA,SAAAC,GAAgC,OAAAhB,EAAAiB,kBAAAD,QAAuC,YAC1eE,EAAA,wBCDIC,EAAM,WAAgB,IAAAnB,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,OAA2BgB,YAAA,UAAqB,CAAAhB,EAAA,OAAAJ,EAAAqB,GAAA,6BAAAjB,EAAA,gBAAmEE,MAAA,CAAOgB,KAAA,QAAAd,GAAA,cAAAe,IAAA,IAAAC,IAAA,OAAwDV,GAAA,CAAKW,OAAAzB,EAAA0B,oBAAgCC,MAAA,CAAQ9C,MAAAmB,EAAA,YAAA4B,SAAA,SAAAC,GAAiD7B,EAAA8B,YAAAD,GAAoBE,WAAA,kBAA2B,GAAA3B,EAAA,OAAAJ,EAAAqB,GAAA,6BAAAjB,EAAA,gBAAuEE,MAAA,CAAOgB,KAAA,QAAAd,GAAA,YAAAe,IAAA,IAAAC,IAAA,OAAsDV,GAAA,CAAKW,OAAAzB,EAAAgC,kBAA8BL,MAAA,CAAQ9C,MAAAmB,EAAA,UAAA4B,SAAA,SAAAC,GAA+C7B,EAAAiC,UAAAJ,GAAkBE,WAAA,gBAAyB,GAAA3B,EAAA,OAAAJ,EAAAqB,GAAA,oBAAAjB,EAAA,gBAA8DE,MAAA,CAAOgB,KAAA,QAAAd,GAAA,YAAAe,IAAA,IAAAC,IAAA,OAAsDV,GAAA,CAAKW,OAAAzB,EAAAkC,kBAA8BP,MAAA,CAAQ9C,MAAAmB,EAAA,UAAA4B,SAAA,SAAAC,GAA+C7B,EAAAmC,UAAAN,GAAkBE,WAAA,gBAAyB,KAAA/B,EAAAoC,GAAA,GAAApC,EAAAoC,GAAA,GAAApC,EAAAoC,GAAA,GAAApC,EAAAoC,GAAA,MAC75BC,EAAe,YAAiB,IAAArC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBgB,YAAA,UAAqB,CAAAhB,EAAA,OAAAJ,EAAAqB,GAAA,WAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,WAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,WAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,UAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,cAA+I,WAAc,IAAArB,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBgB,YAAA,cAAyB,CAAAhB,EAAA,OAAAJ,EAAAqB,GAAA,UAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,aAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,iBAA4F,WAAc,IAAArB,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBgB,YAAA,UAAqB,CAAAhB,EAAA,OAAAJ,EAAAqB,GAAA,UAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,WAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,UAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,eAAmH,WAAc,IAAArB,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBgB,YAAA,UAAqB,CAAAhB,EAAA,OAAAJ,EAAAqB,GAAA,WAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,UAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,QAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,cCwCp0BiB,EAAA,CACAC,MAAA,CACA7B,OAAAhE,QAEAX,KAJA,WAKA,OACA+F,YAAA,EACAG,UAAA,EACAE,UAAA,IAGAK,QAAA,CACAR,iBADA,WAEA/B,KAAAS,OAAA+B,OAAA,KAAAxC,KAAAgC,UAAA,OAEAP,mBAJA,WAKAzB,KAAAS,OAAA+B,OAAAxC,KAAA6B,YAAA,YAEAI,iBAPA,WAQAjC,KAAAS,OAAA+B,OAAA,UAAAxC,KAAAkC,cC5DiVO,EAAA,cCOjVC,EAAgBjG,OAAAkG,EAAA,KAAAlG,CACdgG,EACAvB,EACAkB,GACF,EACA,KACA,KACA,MAIeQ,EAAAF,UClBXG,EAAM,WAAgB,IAAA9C,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BH,EAAAK,MAAAD,GAAwB,OAAAJ,EAAAoC,GAAA,IACrFW,EAAe,YAAiB,IAAA/C,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,OAAAJ,EAAAqB,GAAA,WAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,UAAAjB,EAAA,OAAAJ,EAAAqB,GAAA,iBCQnG2B,EAAA,GCTqVC,EAAA,ECOjVC,EAAYxG,OAAAkG,EAAA,KAAAlG,CACduG,EACAH,EACAC,GACF,EACA,KACA,KACA,MAIeI,EAAAD,UClBXE,EAAM,WAAgB,IAAApD,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,OAAAJ,EAAAqB,GAAA,iBAAAjB,EAAA,gBAAsEE,MAAA,CAAOgB,KAAA,QAAAd,GAAA,UAAAe,IAAA,IAAAC,IAAA,OAAoDV,GAAA,CAAKW,OAAA,SAAAT,GAA0B,OAAAhB,EAAAqD,MAAA,gBAAkClE,IAAA,UAAAN,MAAAmB,EAAAsD,YAA0C3B,MAAA,CAAQ9C,MAAAmB,EAAA,QAAA4B,SAAA,SAAAC,GAA6C7B,EAAAsD,QAAAzB,GAAgBE,WAAA,cAAuB,GAAA3B,EAAA,OAAAJ,EAAAqB,GAAA,eAAAjB,EAAA,gBAAyDE,MAAA,CAAOgB,KAAA,QAAAd,GAAA,QAAAe,IAAA,MAAAC,IAAA,MAAmDV,GAAA,CAAKW,OAAA,SAAAT,GAA0B,OAAAhB,EAAAqD,MAAA,gBAAkClE,IAAA,QAAAN,MAAAmB,EAAAuD,UAAsC5B,MAAA,CAAQ9C,MAAAmB,EAAA,MAAA4B,SAAA,SAAAC,GAA2C7B,EAAAuD,MAAA1B,GAAcE,WAAA,YAAqB,GAAA3B,EAAA,OAAAJ,EAAAqB,GAAA,cAAAjB,EAAA,gBAAwDE,MAAA,CAAOgB,KAAA,QAAAd,GAAA,OAAAe,IAAA,IAAAC,IAAA,OAAiDV,GAAA,CAAKW,OAAA,SAAAT,GAA0B,OAAAhB,EAAAqD,MAAA,gBAAkClE,IAAA,OAAAN,MAAAmB,EAAAwD,SAAoC7B,MAAA,CAAQ9C,MAAAmB,EAAA,KAAA4B,SAAA,SAAAC,GAA0C7B,EAAAwD,KAAA3B,GAAaE,WAAA,WAAoB,MACr/B0B,EAAe,GCiBnBC,EAAA,CACA3H,KADA,WAEA,OACAuH,QAAA,EACAC,MAAA,EACAC,KAAA,KCvBoVG,EAAA,ECOhVC,EAAYlH,OAAAkG,EAAA,KAAAlG,CACdiH,EACAP,EACAK,GACF,EACA,KACA,KACA,MAIeI,EAAAD,kCClBXE,EAAS,CACXC,GAAI,mBAGFC,EAAa,GACbC,EAAW,6DCDTC,aACJ,SAAAA,EAAY3B,GAAO7F,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAAiE,QACHE,IAAV7B,IACFA,EAAQ,IAEVtC,KAAKoE,MAAQ9B,EAAM8B,OAAS,GAC5BpE,KAAKqE,MAAQ/B,EAAM+B,OAAS,EAC5BrE,KAAKsE,MAAQhC,EAAMgC,OAAS,CAAC,GAAK,GAAK,IACvCtE,KAAKuE,KAAOjC,EAAMiC,MAAQ,EAC1BvE,KAAK8D,GAAKxB,EAAMwB,GAChB9D,KAAKwE,QAAU,GACfxE,KAAKyE,QAAUC,KAAKzF,SACpBe,KAAK2E,SAAWD,KAAKzF,SACrBe,KAAK4E,UAAYF,KAAKzF,SACtBe,KAAK6E,KAAOA,KAAK5F,SACjBe,KAAK8E,OAASC,KAAKC,WAAW,EAAK,EAAK,GACxChF,KAAKiF,YAAcF,KAAK9F,SACxBe,KAAKkF,SAAU,EACflF,KAAKmF,GAAK,EACVnF,KAAKoF,GAAK,EACVpF,KAAKqF,GAAK,EACVrF,KAAKsF,SAAW,EAChBtF,KAAKuF,SAAW,EAChBvF,KAAKwF,SAAW,mEAQA1J,EAAM2J,EAAUpE,GAChC,IAAIqE,EAAS7B,EAAOC,GAAG6B,eAevB,YAbaxB,IAAT9C,IACFA,EAAOwC,EAAOC,GAAG8B,qBACjBF,EAAOG,SAAW/J,EAAK+J,UAAY,EAC/B/J,aAAgBgK,eAClBzE,EAAOwC,EAAOC,GAAGiC,aACjBL,EAAOG,SAAW/J,EAAK+J,UAAY,GAErCH,EAAOM,SAAWlK,EAAKQ,OAASoJ,EAAOG,UAGzChC,EAAOC,GAAGmC,WAAW5E,EAAMqE,GAC3B7B,EAAOC,GAAGoC,WAAW7E,EAAMvF,EAAM2J,GACjC5B,EAAOC,GAAGmC,WAAW5E,EAAM,MACpBqE,oCAICA,EAAQS,EAAQrK,GACxB,IAAIuF,EAAOwC,EAAOC,GAAG8B,qBACjB9J,aAAgBgK,eAClBzE,EAAOwC,EAAOC,GAAGiC,cAGnBlC,EAAOC,GAAGmC,WAAW5E,EAAMqE,GAC3B7B,EAAOC,GAAGsC,cAAc/E,EAAM8E,EAAQrK,YAQ1C,SAASuK,EAAcC,EAAQC,EAAS3F,GACtC,IAAI4F,EAASC,EAAYH,EAAQC,GAC7BG,EAAQD,EAAYH,EAAQC,EAAS,EAAa,EAAVI,KAAKC,GAAQhG,GACrDiG,EAASL,EAAOM,OAAOJ,GAEvB9I,EAAQ,GACRxB,EAAI,EAER,IAAKA,EAAI,EAAGA,EAAImK,EAASnK,IACvBwB,EAAMpB,KAAK,EAAGJ,EAAI,EAAGA,GAKvB,IAHAwB,EAAMpB,KAAK,EAAG,EAAGJ,GAGZA,EAAImK,EAAU,EAAGnK,EAAI,EAAImK,EAAU,EAAGnK,IACzCwB,EAAMpB,KAAK+J,EAAU,EAAGnK,EAAGA,EAAI,GAKjC,IAHAwB,EAAMpB,KAAK+J,EAAU,EAAGnK,EAAGmK,EAAU,GAGhCnK,EAAI,EAAGA,EAAImK,EAASnK,IACvBwB,EAAMpB,KAAK+J,EAAU,EAAInK,EAAGA,EAAGA,EAAI,GACnCwB,EAAMpB,KAAK+J,EAAUnK,EAAI,EAAGA,EAAI,EAAGmK,EAAUnK,EAAI,GAKnD,OAHAwB,EAAMpB,KAAK+J,EAAU,EAAInK,EAAGA,EAAG,GAC/BwB,EAAMpB,KAAK+J,EAAUnK,EAAI,EAAG,EAAGmK,EAAU,GAElC,CACLM,OAAQA,EACRjJ,MAAOA,GAWX,SAAS6I,EAAYH,EAAQC,EAASQ,EAAYC,EAAUC,GAC1D,IAAIJ,EAAS,GACTK,EAAI,EACJC,EAAI,EACJC,EAAIH,GAAO,EACXI,EAAQN,GAAc,EACtBO,EAAMN,GAAsB,EAAVL,KAAKC,GAEvBW,GAAUD,EAAMD,GAASd,EAC7BM,EAASA,EAAOC,OAAO,CAACI,EAAGC,EAAG,IAC9B,IAAK,IAAI/K,EAAI,EAAGA,EAAImK,EAASnK,IAC3B8K,EAAIP,KAAKa,IAAIpL,EAAImL,EAASF,GAASf,EACnCa,EAAIR,KAAKc,IAAIrL,EAAImL,EAASF,GAASf,EACnCO,EAASA,EAAOC,OAAO,CAACI,EAAGC,EAAGC,IAEhC,OAAOP,EAWT,SAASa,EAAab,EAAQc,EAAOC,EAAMC,GAGzC,IAFA,IAAIC,EAAI/C,KAAK9F,SACTf,EAAI2J,GAAO,EACNzL,EAAI,EAAGA,EAAIyK,EAAOvK,OAAQF,GAAK,EACtC2I,KAAKgD,IAAID,EAAGjB,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,GAAK8B,GAC1D6G,KAAKiD,QAAQF,EAAGA,EAAG,CAAC,EAAG,EAAG,GAAIH,GAC9B5C,KAAKkD,QAAQH,EAAGA,EAAG,CAAC,EAAG,EAAG,GAAIF,GAC9Bf,EAAOzK,EAAI,GAAK0L,EAAE,GAClBjB,EAAOzK,EAAI,GAAK0L,EAAE,GAClBjB,EAAOzK,EAAI,GAAK0L,EAAE,GAMtB,SAASI,EAASC,GAChB,OAAOA,EAAMxB,KAAKC,GAAK,IASzB,SAASwB,EAAYvB,EAAQvC,EAAO+D,GAClC,IAAIC,EAAW,GACXlM,EAAI,EACR,GAAIkI,EAAMhI,QAAU,EAClB,QAAe6H,IAAXkE,EACF,IAAKjM,EAAI,EAAGA,EAAIyK,EAAOvK,OAAQF,GAAK,EAClCkM,EAAWA,EAASxB,OAAOD,EAAOzK,GAAIyK,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,IAChEkM,EAAWA,EAASxB,OAAOxC,EAAM,GAAIA,EAAM,GAAIA,EAAM,SAElD,GAAI+D,EAAO/L,QAAU,EAC1B,IAAKF,EAAI,EAAGA,EAAIyK,EAAOvK,OAAQF,GAAK,EAClCkM,EAAWA,EAASxB,OAAOD,EAAOzK,GAAIyK,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,IAChEkM,EAAWA,EAASxB,OAAOxC,EAAM,GAAIA,EAAM,GAAIA,EAAM,IACrDgE,EAAWA,EAASxB,OAAOuB,EAAO,GAAIA,EAAO,GAAIA,EAAO,SAG1D,IAAKjM,EAAI,EAAGA,EAAIyK,EAAOvK,OAAQF,GAAK,EAClCkM,EAAWA,EAASxB,OAAOD,EAAOzK,GAAIyK,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,IAChEkM,EAAWA,EAASxB,OAAOxC,EAAM,GAAIA,EAAM,GAAIA,EAAM,IACrDgE,EAAWA,EAASxB,OAAOuB,EAAOjM,GAAIiM,EAAOjM,EAAI,GAAIiM,EAAOjM,EAAI,SAIpE,QAAe+H,IAAXkE,EACF,IAAKjM,EAAI,EAAGA,EAAIyK,EAAOvK,OAAQF,GAAK,EAClCkM,EAAWA,EAASxB,OAAOD,EAAOzK,GAAIyK,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,IAChEkM,EAAWA,EAASxB,OAAOxC,EAAMlI,GAAIkI,EAAMlI,EAAI,GAAIkI,EAAMlI,EAAI,SAE1D,GAAIiM,EAAO/L,QAAU,EAC1B,IAAKF,EAAI,EAAGA,EAAIyK,EAAOvK,OAAQF,GAAK,EAClCkM,EAAWA,EAASxB,OAAOD,EAAOzK,GAAIyK,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,IAChEkM,EAAWA,EAASxB,OAAOxC,EAAMlI,GAAIkI,EAAMlI,EAAI,GAAIkI,EAAMlI,EAAI,IAC7DkM,EAAWA,EAASxB,OAAOuB,EAAO,GAAIA,EAAO,GAAIA,EAAO,SAG1D,IAAKjM,EAAI,EAAGA,EAAIyK,EAAOvK,OAAQF,GAAK,EAClCkM,EAAWA,EAASxB,OAAOD,EAAOzK,GAAIyK,EAAOzK,EAAI,GAAIyK,EAAOzK,EAAI,IAChEkM,EAAWA,EAASxB,OAAOxC,EAAMlI,GAAIkI,EAAMlI,EAAI,GAAIkI,EAAMlI,EAAI,IAC7DkM,EAAWA,EAASxB,OAAOuB,EAAOjM,GAAIiM,EAAOjM,EAAI,GAAIiM,EAAOjM,EAAI,IAKtE,OAAOkM,EAWT,SAASC,EAAWZ,EAAOa,EAAK/J,GAC9B,IAAIgK,EAAK9B,KAAKc,IAAIE,GACde,EAAK/B,KAAKa,IAAIG,GACdgB,EAAKhC,KAAKc,IAAIe,GACdI,EAAKjC,KAAKa,IAAIgB,GACdtB,EAAIzI,EAAIgK,EAAKG,EACbzB,EAAI1I,EAAIgK,EAAKE,EACbvB,EAAI3I,EAAIiK,EAEZ,OAAO3D,KAAKC,WAAWkC,EAAGC,EAAGC,OC1NzByB,cACJ,SAAAA,EAAYvG,GAAO,IAAAwG,EAAA,OAAArM,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAA6I,GACjBC,EAAArM,OAAAsM,EAAA,KAAAtM,CAAAuD,KAAAvD,OAAAuM,EAAA,KAAAvM,CAAAoM,GAAAjM,KAAAoD,KAAMsC,IACNwG,EAAKzH,KAAO,QACZyH,EAAKxM,OAAS,GACdwM,EAAKG,OAJYH,4EAQjB,IAAII,EAAS7C,EAAc,IAAMrG,KAAKoE,MAAOpE,KAAK1D,QAClDoL,EAAawB,EAAOrC,OAAQqB,EAAS,IAAK,GAC1C,IAAIiB,EAAYf,EAAYc,EAAOrC,OAAQ,CAAC,GAAK,GAAK,GAAM,CAAC,EAAK,EAAK,IAEnEuC,EAAS/C,EAAc,IAAMrG,KAAKoE,MAAOpE,KAAK1D,QAClDoL,EAAa0B,EAAOvC,OAAQqB,EAAS,IAAKA,EAAS,KACnD,IAAImB,EAAYjB,EAAYgB,EAAOvC,OAAQ,CAAC,EAAK,GAAK,GAAM,CAAC,EAAK,EAAK,IAEnEyC,EAASjD,EAAc,IAAMrG,KAAKoE,MAAOpE,KAAK1D,QAC9CiN,EAAYnB,EAAYkB,EAAOzC,OAAQ,CAAC,EAAK,EAAK,IAAM,CAAC,EAAK,EAAK,IAEnEyB,EAAW,GACfA,EAAWA,EAASxB,OAAOqC,GAC3Bb,EAAWA,EAASxB,OAAOuC,GAC3Bf,EAAWA,EAASxB,OAAOyC,GAE3B,IAAI3L,EAAQ,GACZA,EAAQA,EAAMkJ,OAAOoC,EAAOtL,OAG5B,IADA,IAAItB,EAAS,EAAI0D,KAAKoE,MAAQ,EACrBhI,EAAI,EAAGA,EAAIgN,EAAOxL,MAAMtB,OAAQF,IACvCwB,EAAMpB,KAAKF,EAAS8M,EAAOxL,MAAMxB,IAGnCE,EAAS,EAAI0D,KAAKoE,MAAQ,EAC1B,IAAShI,EAAI,EAAGA,EAAIkN,EAAO1L,MAAMtB,OAAQF,IACvCwB,EAAMpB,KAAKF,EAASgN,EAAO1L,MAAMxB,IAEnC4D,KAAKwE,QAAQqC,OAAS7G,KAAKwJ,kBAAkB,IAAI1D,aAAawC,GAAWzE,EAAOC,GAAG2F,aACnFzJ,KAAKwE,QAAQ5G,MAAQoC,KAAKwJ,kBAAkB,IAAIE,YAAY9L,GAAQiG,EAAOC,GAAG2F,aAC9EzJ,KAAKwE,QAAQ5G,MAAMoI,SAAWpI,EAAMtB,uCAIpCuH,EAAOC,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKqE,OACzCR,EAAOC,GAAG8F,iBAAiB5F,EAAS6F,UAAU,EAAO7J,KAAKyE,SAC1DZ,EAAOC,GAAG8F,iBAAiB5F,EAAS8F,YAAY,EAAO9J,KAAK4E,WAE5Df,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAGiC,aAAc/F,KAAKwE,QAAQqC,QAC1DhD,EAAOC,GAAGiG,oBAAoBhG,EAAWiG,gBAAiB,EAAGnG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC5FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWO,MAAO,EAAGT,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAClFpG,EAAOC,GAAGiG,oBAAoBhG,EAAWmG,cAAe,EAAGrG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAC1FpG,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAKwE,QAAQ5G,OAClEiG,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGsG,UAAWpK,KAAKwE,QAAQ5G,MAAMoI,SAAUnC,EAAOC,GAAGuG,eAAgB,yCAGvFC,GACZtK,KAAK2E,SAAW2F,GAAUtK,KAAK2E,SAC/BD,KAAK6F,IAAIvK,KAAK4E,UAAW5E,KAAK2E,SAAU3E,KAAKyE,gBAzD7BR,GA+DL4E,ICxDT2B,aAOJ,SAAAA,EAAYlI,GAAO7F,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAAwK,GAAAxK,KANnByK,aAAe,GAMIzK,KALnB0K,WAAa,GAKM1K,KAJnB2K,WAAa,GAIM3K,KAHnB4K,iBAAmB,IAGA5K,KAFnB6K,kBAAoB,IAIlB7K,KAAKqB,KAAO,SAEZrB,KAAK2H,MAAQrF,EAAMqF,OAAS3H,KAAKyK,aACjCzK,KAAK2H,MAAQO,EAASlI,KAAK2H,OAC3B3H,KAAKwI,IAAMlG,EAAMkG,KAAOxI,KAAK0K,WAC7B1K,KAAKwI,IAAMN,EAASlI,KAAKwI,KACzBxI,KAAK6H,IAAMvF,EAAMuF,KAAO7H,KAAK2K,WAE7B3K,KAAKW,MAAQ2B,EAAM3B,OAASX,KAAK4K,iBACjC5K,KAAKY,OAAS0B,EAAM1B,QAAUZ,KAAK6K,kBACnC7K,KAAKiH,IAAMsB,EAAWvI,KAAK2H,MAAO3H,KAAKwI,IAAKxI,KAAK6H,KACjD7H,KAAK8K,GAAK/F,KAAKC,WAAW,EAAG,EAAG,GAChChF,KAAK+K,OAAShG,KAAKC,WAAW,EAAG,EAAG,GACpChF,KAAKgL,QAAUtG,KAAKzF,SACpBe,KAAKiL,QAAUvG,KAAKzF,SACpBe,KAAK2E,SAAWD,KAAKzF,SAErBe,KAAKkL,QAAQlL,KAAKW,MAAOX,KAAKY,gEAO9B8D,KAAKyG,OAAOnL,KAAKiL,QAASjL,KAAKiH,IAAKjH,KAAK+K,OAAQ/K,KAAK8K,IACtDpG,KAAK6F,IAAIvK,KAAK2E,SAAU3E,KAAKgL,QAAShL,KAAKiL,cACtB9G,IAAjBnE,KAAKoL,SACPpL,KAAKoL,QAAQpL,KAAK2E,uCAOjByG,GACHpL,KAAKoL,QAAUA,iCAYVC,EAASC,EAAO7M,GAClB4M,IACGA,EAAU,IACZA,EAAU,IACDA,EAAU,SACnBA,EAAU,QAEZrL,KAAK2H,MAAQO,EAASmD,IAErBC,IACDtL,KAAKwI,IAAMN,EAASoD,IAEnB7M,IACDuB,KAAK6H,IAAMpJ,GAMbuB,KAAKiH,IAAMsB,EAAWvI,KAAK2H,MAAO3H,KAAKwI,IAAKxI,KAAK6H,KACjD7H,KAAKuL,yCAMC5K,EAAOC,GACbZ,KAAKW,MAAQA,EACbX,KAAKY,OAASA,EACdiD,EAAOC,GAAG0H,SAAS,EAAG,EAAG7K,EAAOC,GAChC8D,KAAK+G,YAAYzL,KAAKgL,QAAS,IAAWrE,KAAKC,GAAIjG,EAAQC,EAAQ,GAAK,KACxEZ,KAAKuL,yCAOLvL,KAAKwC,OAAOxC,KAAKyK,aAAczK,KAAK0K,WAAY1K,KAAK6H,KACrD7H,KAAKuL,kBAaHG,aAKJ,SAAAA,EAAYpJ,GAAO7F,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAA0L,GACjB,IAAI5H,EAAKD,EAAOC,GAEhBA,EAAG6H,OAAO7H,EAAG8H,YACb9H,EAAG+H,UAAU/H,EAAGgI,MAChBhI,EAAG6H,OAAO7H,EAAGiI,WACbjI,EAAGkI,SAASlI,EAAGmI,MACfnI,EAAGoI,WAAW,IAAM,IAAM,IAAM,GAChCpI,EAAGqI,WAAW,GACdrI,EAAGsI,YAAYtI,EAAGuI,qBAAqB,GACvCvI,EAAG6H,OAAO7H,EAAGwI,OACbxI,EAAGyI,UAAUzI,EAAG0I,UAAW1I,EAAG2I,qBAC9BzM,KAAKqB,KAAO,QACZrB,KAAK0M,KAAO,GACZ1M,KAAK2M,aAAe,CAAC,IAAM,IAAM,uDAQ/BC,EAAKC,QACK1I,IAARyI,GAKAC,EACF7M,KAAK0M,KAAKI,QAAQF,GAElB5M,KAAK0M,KAAKlQ,KAAKoQ,QAEGzI,IAAhBnE,KAAKS,QAEPT,KAAKS,OAAO8K,UAXZwB,QAAQC,IAAI,uEAoBNvM,GAAQ,IAAAqI,EAAA9I,KAChBA,KAAKS,OAASA,EACdA,EAAOwM,KAAK,SAAC3C,GAIX,IAAK,IAAIlO,EAAI,EAAGA,EAAI0M,EAAK4D,KAAKpQ,OAAQF,IACpC0M,EAAK4D,KAAKtQ,GAAG8Q,cAAc5C,sCAU/BtK,KAAKmN,SAAU,EACf,IAAIC,EAAQpN,KACZ,SAASvB,IACPoF,EAAOC,GAAGuJ,MAAMxJ,EAAOC,GAAGwJ,iBAAmBzJ,EAAOC,GAAGyJ,kBACvD,IAAK,IAAInR,EAAI,EAAGA,EAAIgR,EAAMV,KAAKpQ,OAAQF,IACrCgR,EAAMV,KAAKtQ,GAAGoR,QAEbJ,EAAMD,SACPM,sBAAsBhP,GAG1BgP,sBAAsBhP,qCAadqF,EAAI4J,EAASrM,GAErB,IAAIsM,EAAS7J,EAAG8J,aAAavM,GAM7B,OAJAyC,EAAG+J,aAAaF,EAAQD,GAExB5J,EAAGgK,cAAcH,GAEZ7J,EAAGiK,mBAAmBJ,EAAQ7J,EAAGkK,gBAM/BL,GALLZ,QAAQC,IAAI,4BACZD,QAAQC,IAAIlJ,EAAGmK,iBAAiBN,IACzB,0CAYCO,EAAYC,GACtB,IAAIC,EAAgBvK,EAAOC,GAAGuK,gBAC1BC,EAAetO,KAAKuO,UAAU1K,EAAOC,GAAIoK,EAAYrK,EAAOC,GAAG0K,eACnE3K,EAAOC,GAAG2K,aAAaL,EAAeE,GAEtC,IAAII,EAAa1O,KAAKuO,UAAU1K,EAAOC,GAAIqK,EAAUtK,EAAOC,GAAG6K,iBAC/D9K,EAAOC,GAAG2K,aAAaL,EAAeM,GACtC1O,KAAK4O,eAAeR,0CAQPA,GACbvK,EAAOC,GAAG+K,YAAYT,GACtBvK,EAAOC,GAAGgL,WAAWV,GAErBrK,EAAWiG,gBAAkBnG,EAAOC,GAAGiL,kBAAkBX,EAAe,mBACxEvK,EAAOC,GAAGkL,wBAAwBjL,EAAWiG,iBAE7CjG,EAAWmG,cAAgBrG,EAAOC,GAAGiL,kBAAkBX,EAAe,iBACtEvK,EAAOC,GAAGkL,wBAAwBjL,EAAWmG,eAE7CnG,EAAWO,MAAQT,EAAOC,GAAGiL,kBAAkBX,EAAe,UAC9DvK,EAAOC,GAAGkL,wBAAwBjL,EAAWO,OAE7CP,EAAWkL,QAAUpL,EAAOC,GAAGiL,kBAAkBX,EAAe,YAChErK,EAAWO,MAAQT,EAAOC,GAAGiL,kBAAkBX,EAAe,UAE9DpK,EAAS8F,WAAajG,EAAOC,GAAGoL,mBAAmBd,EAAe,cAClEpK,EAAS6F,SAAWhG,EAAOC,GAAGoL,mBAAmBd,EAAe,YAChEpK,EAASmL,SAAWtL,EAAOC,GAAGoL,mBAAmBd,EAAe,YAChEpK,EAASK,MAAQR,EAAOC,GAAGoL,mBAAmBd,EAAe,UAC7DpK,EAASoL,WAAavL,EAAOC,GAAGoL,mBAAmBd,EAAe,cAClEpK,EAASqL,YAAcxL,EAAOC,GAAGoL,mBAAmBd,EAAe,eACnEpK,EAASsL,gBAAkBzL,EAAOC,GAAGoL,mBAAmBd,EAAe,mBACvEpK,EAASuL,UAAY1L,EAAOC,GAAGoL,mBAAmBd,EAAe,cACjEpK,EAASwL,YAAc3L,EAAOC,GAAGoL,mBAAmBd,EAAe,cAEnEvK,EAAOC,GAAG8F,iBAAiB5F,EAASmL,UAAU,EAAOzK,KAAKzF,UAC1D4E,EAAOC,GAAG2L,WAAWzL,EAASsL,gBAAiBtP,KAAK2M,uBC1QlD+C,cACJ,SAAAA,EAAYpN,GAAO,IAAAwG,EAAA,OAAArM,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAA0P,GAEjB5G,EAAArM,OAAAsM,EAAA,KAAAtM,CAAAuD,KAAAvD,OAAAuM,EAAA,KAAAvM,CAAAiT,GAAA9S,KAAAoD,KAAMsC,IACNwG,EAAKzH,KAAO,cAKZyH,EAAK6G,UAAYrN,EAAMqN,WAAa,CAAC,EAAK,EAAK,GAC/C7G,EAAKjB,IAAM,EACXiB,EAAKxF,MAAQ,EACbwF,EAAKzF,QAAU,EACfyF,EAAK8G,cAAgB,EACrB9G,EAAKvF,KAAO,EACZuF,EAAK+G,UAAY,GACjB/G,EAAKG,OAfYH,4EAmBjB,IAAIgH,EAAWzJ,EAAcrG,KAAKuE,KAAMvE,KAAKoE,MAAO,KAEhDyC,EAASiJ,EAASjJ,OAClBjJ,EAAQkS,EAASlS,MAEjBxB,EAAI,EACJkI,EAAQ,GACZ,IAAKlI,EAAI,EAAGA,GAAK4D,KAAKoE,MAAOhI,IAC3BkI,EAAQA,EAAMwC,OAAO9G,KAAK2P,WAE5B,IAAKvT,EAAI,EAAGA,GAAK4D,KAAKoE,MAAOhI,IAC3BkI,EAAQA,EAAMwC,OAAO9G,KAAKsE,OAG5B,IAAIgE,EAAWF,EAAYvB,EAAQvC,EAAO,CAAC,EAAG,EAAG,IACjDtE,KAAK+P,YAAcnS,EAAMtB,OAEzB0D,KAAKwE,QAAQqC,OAAS7G,KAAKwJ,kBAAkB,IAAI1D,aAAawC,GAAWzE,EAAOC,GAAG2F,aACnFzJ,KAAKwE,QAAQ5G,MAAQoC,KAAKwJ,kBAAkB,IAAIE,YAAY9L,GAAQiG,EAAOC,GAAG2F,6CAI9E5F,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAGiC,aAAc/F,KAAKwE,QAAQqC,QAC1DhD,EAAOC,GAAGiG,oBAAoBhG,EAAWiG,gBAAiB,EAAGnG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC5FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWO,MAAO,EAAGT,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAClFpG,EAAOC,GAAGiG,oBAAoBhG,EAAWmG,cAAe,EAAGrG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAE1FpG,EAAOC,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKqE,OAEzCR,EAAOC,GAAG8F,iBAAiB5F,EAAS6F,UAAU,EAAO7J,KAAKyE,SAC1DZ,EAAOC,GAAG8F,iBAAiB5F,EAAS8F,YAAY,EAAO9J,KAAK4E,WAE5Df,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAKwE,QAAQ5G,OAClEiG,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGsG,UAAWpK,KAAK+P,YAAalM,EAAOC,GAAGuG,eAAgB,yCAG5EC,GACZtK,KAAK2E,SAAW2F,GAAUtK,KAAK2E,SAC/BD,KAAK6F,IAAIvK,KAAK4E,UAAW5E,KAAK2E,SAAU3E,KAAKyE,0CAGtCF,GACPvE,KAAKuE,KAAOA,EACZQ,KAAKgD,IAAI/H,KAAK8E,OAAQP,EAAMA,EAAMA,GAClCvE,KAAKuL,gDASQ9M,EAAG4M,EAASC,GACzBtL,KAAKiF,YAAcsD,EAAWL,EAASmD,GAAUnD,EAASoD,GAAQ7M,GAClEoG,KAAKmL,UAAUhQ,KAAK6E,KAAM,EAAGwG,EAASC,GACtCtL,KAAKuL,0CAWE0E,GAEPjQ,KAAK6H,IAAMoI,EAAOpI,KAAO7H,KAAK6H,IAC3BoI,EAAO3M,QACRtD,KAAKsD,MAAQ2M,EAAO3M,OAEnB2M,EAAO5M,UACRrD,KAAKqD,QAAU4M,EAAO5M,QACtB4M,EAAO5M,QAAU4M,EAAO5M,QAAUrD,KAAK4P,eAEtCK,EAAO1M,OACRvD,KAAKuD,KAAO0M,EAAO1M,MAErB,IAAIoE,EAAQ,GAAK3H,KAAKsD,MACtBtD,KAAKkQ,eAAelQ,KAAK6H,IAAKF,EAAO3H,KAAKqD,0CAO1CqB,KAAKyL,6BAA6BnQ,KAAKyE,QACrCzE,KAAK6E,KACL7E,KAAKiF,YACLjF,KAAK8E,QACP9E,KAAKkN,gBAGL,IADA,IAAIkD,EAAYpQ,KAAKoQ,YACZhU,EAAI,EAAGA,EAAI4D,KAAK6P,UAAUvT,OAAQF,IACzC4D,KAAK6P,UAAUzT,GAAG,CAChByL,IAAK7H,KAAK6H,IAAKvE,MAAOtD,KAAKsD,MAAOD,QAASrD,KAAKqD,QAChDE,KAAMvD,KAAKuD,KAAMoE,MAAOyI,EAAU,GAAI5H,IAAK4H,EAAU,GACrD7L,KAAMvE,KAAKuE,gDAQA8L,GACfrQ,KAAK6P,UAAUrT,KAAK6T,uCAUpB,IAAIC,GAAK,GAAKtQ,KAAKsD,OAAS,IAAMqD,KAAKC,GACnCkB,EAAI9H,KAAKqD,QAAU,IAAMsD,KAAKC,GAClC,OAAO7B,KAAKC,WAAWsL,EAAGxI,EAAG9H,KAAK6H,qCAKlC7H,KAAK4P,eAAiB5P,KAAKqD,QAE3BrD,KAAKuQ,SAAS,CAAEjN,MAAOtD,KAAKsD,MAAOD,QAASrD,KAAKqD,QAASE,KAAMvD,KAAKuD,KAAMsE,IAAK7H,KAAK6H,aAnJ/D5D,GAiKpBuM,cAEJ,SAAAA,EAAYlO,GAAO,IAAAmO,EAAA,OAAAhU,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAAwQ,GACjBC,EAAAhU,OAAAsM,EAAA,KAAAtM,CAAAuD,KAAAvD,OAAAuM,EAAA,KAAAvM,CAAA+T,GAAA5T,KAAAoD,KAAMsC,IADWmO,EADnBC,WAAa,MAGXD,EAAKpP,KAAO,aACZoP,EAAKE,gBAAkB,EACvBF,EAAKG,eAAiB,EACtBH,EAAKI,gBAAkB,EACvBJ,EAAKK,OAAS,EACdL,EAAKM,kBAAsC,EAAlBN,EAAKC,WAC9BD,EAAKO,mBAAuC,EAAlBP,EAAKC,WAC/BD,EAAKQ,IAAM,EACXR,EAAKS,GAAK,EACVT,EAAK9P,MAAQ,EACb8P,EAAKxH,OAZYwH,4EAiBjBzQ,KAAKmR,MAAQnR,KAAKoR,WAClBpR,KAAKqR,KAAO,GACZrR,KAAKpC,MAAQ,GAGboC,KAAKwE,QAAQ6M,KAAO,GACpBrR,KAAKwE,QAAQ5G,MAAQ,GAErBoC,KAAK2F,+CAIL,GAAK3F,KAAKkF,QAAV,CAGArB,EAAOC,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKqE,OACzCR,EAAOC,GAAG8F,iBAAiB5F,EAAS6F,UAAU,EAAO7J,KAAKyE,SAC1DZ,EAAOC,GAAG8F,iBAAiB5F,EAAS8F,YAAY,EAAO9J,KAAK4E,WAG5D,IAAK,IAAIxI,EAAI,EAAGA,EAAI4D,KAAK8Q,OAAQ1U,IAC/ByH,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAGiC,aAAc/F,KAAKwE,QAAQ6M,KAAKjV,IAC/DyH,EAAOC,GAAGiG,oBAAoBhG,EAAWmG,cAAe,EAAGrG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC1FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWiG,gBAAiB,EAAGnG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC5FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWO,MAAO,EAAGT,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAClFpG,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAKwE,QAAQ5G,MAAMxB,IACxEyH,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGsG,UAAWpK,KAAK0Q,WAAY7M,EAAOC,GAAGuG,eAAgB,GAErFrK,KAAK6Q,gBAAkB,IAEzBhN,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAGiC,aAAc/F,KAAKwE,QAAQ6M,KAAKrR,KAAK8Q,SACpEjN,EAAOC,GAAGiG,oBAAoBhG,EAAWmG,cAAe,EAAGrG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC1FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWiG,gBAAiB,EAAGnG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC5FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWO,MAAO,EAAGT,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAClFpG,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAKwE,QAAQ5G,MAAMoC,KAAK8Q,SAC7EjN,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGsG,UAAWpK,KAAK6Q,gBAAiBhN,EAAOC,GAAGuG,eAAgB,2CAIlFC,GACZtK,KAAK2E,SAAW2F,GAAUtK,KAAK2E,SAC/BD,KAAK6F,IAAIvK,KAAK4E,UAAW5E,KAAK2E,SAAU3E,KAAKyE,8CAOlC6M,GACX,IAAIC,EAAS,CAACvR,KAAKoR,WAAWzJ,MAAO3H,KAAKoR,WAAW5I,IAAKxI,KAAKoR,WAAWvJ,KACtE2J,EAAUxR,KAAKyR,eAAeH,EAAQC,GAC1CvR,KAAK2Q,iBAAmBa,EAAQ5T,MAAMtB,OAEtC0D,KAAK0R,UAAU1R,KAAKwE,QAAQ6M,KAAKrR,KAAK8Q,QAA+B,EAAtB9Q,KAAK4Q,eAAoB,IAAI9K,aAAa0L,EAAQlJ,WACjGtI,KAAK0R,UAAU1R,KAAKwE,QAAQ5G,MAAMoC,KAAK8Q,QAAgC,EAAvB9Q,KAAK6Q,gBAAqB,IAAInH,YAAY8H,EAAQ5T,QAIlGoC,KAAK4Q,gBAAkBY,EAAQlJ,SAAShM,OACxC0D,KAAK6Q,iBAAmBW,EAAQ5T,MAAMtB,OAIlC0D,KAAK6Q,iBAAmB7Q,KAAK0Q,aAC/B1Q,KAAK8Q,SACL/D,QAAQC,IAAI,uCACZhN,KAAK2F,eACL3F,KAAK2R,mDAIFV,GACLjR,KAAKiR,IAAMA,kCAGL1M,GACNvE,KAAKuE,KAAOA,yCASChF,EAAGqS,GAChB,IAWI/K,EAXAgL,EAAKtJ,EAAWhJ,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAC9BuS,EAAKvJ,EAAWqJ,EAAG,GAAIA,EAAG,GAAIA,EAAG,IACjClU,EAAI,CAACmU,EAAG,GAAKC,EAAG,GAAID,EAAG,GAAKC,EAAG,GAAID,EAAG,GAAKC,EAAG,IAE9CC,EAAKxJ,EAA4B,IAAhBhJ,EAAE,GAAKqS,EAAG,IAA4B,IAAhBrS,EAAE,GAAKqS,EAAG,IAAWrS,EAAE,IAC9DxB,EAAIgH,KAAK9F,SACb8F,KAAKiN,MAAMjU,EAAGL,EAAGqU,GACjBhN,KAAKkN,UAAUlU,EAAGA,GAClBgH,KAAKmN,MAAMnU,EAAGA,EAAe,IAAZiC,KAAKuE,MAItB,IAAI+D,EAAW,GACX6J,EAAOnS,KAEPoS,EAAa,WACf9J,EAAWA,EAASxB,OAAOD,GAC3ByB,EAAWA,EAASxB,OAAOqL,EAAK7N,QAGlCuC,EAAS,CAACgL,EAAG,GAAK9T,EAAE,GAAI8T,EAAG,GAAK9T,EAAE,GAAI8T,EAAG,GAAK9T,EAAE,IAChDqU,IACAvL,EAAS,CAACgL,EAAG,GAAK9T,EAAE,GAAI8T,EAAG,GAAK9T,EAAE,GAAI8T,EAAG,GAAK9T,EAAE,IAChDqU,IACAvL,EAAS,CAACiL,EAAG,GAAK/T,EAAE,GAAI+T,EAAG,GAAK/T,EAAE,GAAI+T,EAAG,GAAK/T,EAAE,IAChDqU,IACAvL,EAAS,CAACiL,EAAG,GAAK/T,EAAE,GAAI+T,EAAG,GAAK/T,EAAE,GAAI+T,EAAG,GAAK/T,EAAE,IAChDqU,IAGA,IAAIxU,EAAQ,GACRyU,EAAM,EACNjT,EAAIY,KAAK4Q,eAAiByB,EAI9B,OAHAzU,EAAMpB,KAAK4C,EAAI,EAAGA,EAAI,EAAGA,EAAI,EAAGA,EAAI,EAAGA,EAAI,EAAGA,EAAI,GAClDxB,EAAMpB,KAAK4C,EAAI,EAAGA,EAAI,EAAGA,EAAI,EAAGA,EAAI,EAAGA,EAAI,EAAGA,EAAI,GAE3C,CAGLkJ,SAAYA,EACZ1K,MAASA,8CAIMqS,QACO9L,IAApBnE,KAAKoR,aACPpR,KAAKoR,WAAanB,GAIpB,IAAIqC,EAAO/J,EAAWvI,KAAKoR,WAAWzJ,MAAO3H,KAAKoR,WAAW5I,IAAKxI,KAAKoR,WAAWvJ,KAC9EZ,EAAMsB,EAAW0H,EAAOtI,MAAOsI,EAAOzH,IAAKyH,EAAOpI,KAClD0K,EAAOxN,KAAKwN,KAAKD,EAAMrL,GACvBkK,EAAQ,CAAClB,EAAOtI,MAAOsI,EAAOzH,IAAKyH,EAAOpI,KAE1C0K,EAAO5L,KAAKC,GAAKqJ,EAAOpI,IAAM,OAChC7H,KAAKwS,aAAarB,GAClBnR,KAAKmR,MAAQA,EACbnR,KAAKoR,WAAanB,4CAwBLwC,GACfzS,KAAK4Q,eAAiB,EACtB5Q,KAAK6Q,gBAAkB,EACvB7Q,KAAKkR,GAAK,uCAGCwB,GAEX,IAAK,IAAItW,EAAI,EAAGA,GAAK4D,KAAK8Q,OAAQ1U,IAChC0H,GAAG6O,aAAa3S,KAAKwE,QAAQ6M,KAAKjV,IAClC0H,GAAG6O,aAAa3S,KAAKwE,QAAQ5G,MAAMxB,IAErC4D,KAAK2Q,gBAAkB,EACvB3Q,KAAK8Q,OAAS,EACd9Q,KAAKoR,gBAAajN,EAClBnE,KAAK2R,0DAIL3R,KAAKwE,QAAQ6M,KAAKrR,KAAK8Q,QAAU9Q,KAAKwJ,kBAAkBxJ,KAAK+Q,kBAAmBlN,EAAOC,GAAG8O,aAAc/O,EAAOC,GAAGiC,cAClH/F,KAAKwE,QAAQ5G,MAAMoC,KAAK8Q,QAAU9Q,KAAKwJ,kBAAkBxJ,KAAKgR,mBAAoBnN,EAAOC,GAAG8O,aAAc/O,EAAOC,GAAG8B,6BA/M/F3B,GA0NnB4O,cACJ,SAAAA,EAAYvQ,GAAO,IAAAwQ,EAAA,OAAArW,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAA6S,GACjBC,EAAArW,OAAAsM,EAAA,KAAAtM,CAAAuD,KAAAvD,OAAAuM,EAAA,KAAAvM,CAAAoW,GAAAjW,KAAAoD,KAAMsC,IACNwQ,EAAKzR,KAAO,cACZyR,EAAKC,WAA0B,IAAbD,EAAK1O,MACvB0O,EAAKE,aAAe,EACpBF,EAAK/C,YAAc,EACnB+C,EAAK7J,OANY6J,4EAUjB9S,KAAKwE,QAAQqC,OAAS7G,KAAKwJ,kBAAoC,EAAlBxJ,KAAK+S,WAAgBlP,EAAOC,GAAG8O,aAAc/O,EAAOC,GAAGiC,cACpG/F,KAAKwE,QAAQ5G,MAAQoC,KAAKwJ,kBAAoC,EAAlBxJ,KAAK+S,WAAgBlP,EAAOC,GAAG8O,aAAc/O,EAAOC,GAAG8B,sDAKzE,IAAtB5F,KAAKgT,cAAuBhT,KAAKkF,UAIrCpB,GAAGmC,WAAWnC,GAAGiC,aAAc/F,KAAKwE,QAAQqC,QAC5C/C,GAAGiG,oBAAoBhG,EAAWmG,cAAe,EAAGpG,GAAGmG,OAAO,EAAO,GAAO,GAC5EnG,GAAGiG,oBAAoBhG,EAAWiG,gBAAiB,EAAGlG,GAAGmG,OAAO,EAAO,GAAO,GAC9EnG,GAAGiG,oBAAoBhG,EAAWO,MAAO,EAAGR,GAAGmG,OAAO,EAAO,GAAO,IACpEnG,GAAGmC,WAAWnC,GAAG8B,qBAAsB5F,KAAKwE,QAAQ5G,OAEpDkG,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKqE,OAClCP,GAAG8F,iBAAiB5F,EAAS6F,UAAU,EAAO7J,KAAKyE,SACnDX,GAAG8F,iBAAiB5F,EAAS8F,YAAY,EAAO9J,KAAK4E,WACrDd,GAAGqG,aAAarG,GAAGsG,UAAWpK,KAAK+P,YAAajM,GAAGuG,eAAgB,0CAGtDC,GACbtK,KAAK2E,SAAW2F,GAAUtK,KAAK2E,SAC/BD,KAAK6F,IAAIvK,KAAK4E,UAAW5E,KAAK2E,SAAU3E,KAAKyE,yCAGtCF,GACPvE,KAAKuE,KAAOA,EACZQ,KAAKC,WAAWhF,KAAK8E,OAAQP,EAAMA,EAAMA,GACzCG,KAAKyL,6BAA6BnQ,KAAKyE,QAASzE,KAAK6E,KAAM7E,KAAKiF,YAAajF,KAAK8E,QAClF9E,KAAKkN,iDAIL,GAAKlN,KAAKkF,QAAV,CAIA6H,QAAQC,IAAI,2BAEZ,IAAI5Q,EAAI,EACJ6W,EAAQ,GACRrV,EAAQ,GAEZqV,EAAQxM,YAAYzG,KAAKuE,KAAMvE,KAAKoE,MAAO,EAAa,EAAVuC,KAAKC,IACnDc,aAAauL,EAAOjT,KAAK2H,MAAO3H,KAAKwI,IAAKxI,KAAK6H,KAE/C,IAAIS,EAAWF,EAAY6K,EAAO,CAAC,EAAK,GAAK,KAEzC7T,EAAIY,KAAKgT,aAAe,EAC5B,IAAK5W,EAAI,EAAGA,EAAI4D,KAAKoE,MAAOhI,IAC1BwB,EAAMpB,KAAK4C,EAAGA,EAAIhD,EAAGgD,EAAIhD,EAAI,EAC3BgD,EAAGA,EAAIhD,EAAI,EAAGgD,EAAIhD,GAGtBwB,EAAMpB,KAAK4C,EAAGA,EAAIY,KAAKoE,MAAOhF,EAAI,EAChCA,EAAGA,EAAI,EAAGA,EAAIY,KAAKoE,OAErBpE,KAAK0R,UAAU1R,KAAKwE,QAAQqC,OAA4B,EAApB7G,KAAKgT,aAAkB,IAAIlN,aAAawC,IAC5EtI,KAAK0R,UAAU1R,KAAKwE,QAAQ5G,MAA0B,EAAnBoC,KAAK+P,YAAiB,IAAIrG,YAAY9L,IAEzEoC,KAAKgT,cAAgB1K,EAAShM,OAC9B0D,KAAK+P,aAAenS,EAAMtB,mDAGR2T,GAClBjQ,KAAK2H,MAAQsI,EAAOtI,MACpB3H,KAAKwI,IAAMyH,EAAOzH,IAClBxI,KAAK6H,IAAmB,KAAboI,EAAOpI,IAClB7H,KAAKuE,KAAqB,IAAd0L,EAAO1L,qCAKnBvE,KAAKgT,aAAe,EACpBhT,KAAK+P,YAAc,SAvFG9L,GC9XpBiP,aACJ,SAAAA,EAAY5Q,GAAO7F,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAAkT,GACjBjP,SAASrH,KAAKoD,MACdA,KAAKqB,KAAO,QACZrB,KAAKmT,IAAM,yBACX,IAAIjB,EAAQ5P,EAAMiC,MAAQ,EAC1BvE,KAAKoT,SAASlB,GACdlS,KAAKiJ,6DAGL,IAAIkJ,EAAOnS,KACXqT,SAASrT,KAAKmT,IAAK,SAAUG,GAC3BnB,EAAKoB,KAAO,IAAIC,UAAUC,IAAIC,KAAKJ,GACnCE,UAAUC,IAAIE,gBAAgB7P,GAAIqO,EAAKoB,6CAMvBpP,IAAdnE,KAAKuT,MAAuBvT,KAAKkF,UAIrCpB,GAAG6F,UAAU3F,SAASK,MAAOrE,KAAKqE,OAGlCP,GAAG8P,UAAU5P,SAASuL,UAAW,GACjCzL,GAAG2L,WAAWzL,SAASwL,YAAaxP,KAAKsE,OAEzCR,GAAGmC,WAAWnC,GAAGiC,aAAc/F,KAAKuT,KAAKM,cACzC/P,GAAGiG,oBAAoBhG,WAAWiG,gBAAiBhK,KAAKuT,KAAKM,aAAahO,SAAU/B,GAAGmG,OAAO,EAAO,EAAG,GAaxGnG,GAAGmC,WAAWnC,GAAGiC,aAAc/F,KAAKuT,KAAKO,cACzChQ,GAAGiG,oBAAoBhG,WAAWmG,cAAelK,KAAKuT,KAAKO,aAAajO,SAAU/B,GAAGmG,OAAO,EAAO,EAAG,GAEtGnG,GAAG8F,iBAAiB5F,SAAS6F,UAAU,EAAO7J,KAAKyE,SACnDX,GAAG8F,iBAAiB5F,SAAS8F,YAAY,EAAO9J,KAAK4E,WAErDd,GAAGmC,WAAWnC,GAAG8B,qBAAsB5F,KAAKuT,KAAKQ,aACjDjQ,GAAGqG,aAAarG,GAAGsG,UAAWpK,KAAKuT,KAAKQ,YAAY/N,SAAUlC,GAAGuG,eAAgB,GAGjFvG,GAAG8P,UAAU5P,SAASuL,WAAW,0CAGrBjF,GACZtK,KAAK2E,SAAW2F,GAAUtK,KAAK2E,SAC/BD,KAAK6F,IAAIvK,KAAK4E,UAAW5E,KAAK2E,SAAU3E,KAAKyE,6CAQnCwL,GACVjQ,KAAKsD,MAAQ2M,EAAO3M,MACpBtD,KAAKqD,QAAU4M,EAAO5M,QACtBrD,KAAKuD,KAAO0M,EAAO1M,KAEnBmB,KAAKsP,YAAYhU,KAAKyE,QAASzE,KAAK8E,QAQpCJ,KAAKuP,QAAQjU,KAAKyE,QAASzE,KAAKyE,QAASyD,SAAS,KAElDxD,KAAKsD,QAAQhI,KAAKyE,QAASzE,KAAKyE,QAASyD,SAAS+H,EAAO5M,QAAU,MACnEqB,KAAKuP,QAAQjU,KAAKyE,QAASzE,KAAKyE,QAASyD,SAAS+H,EAAO3M,QACzDoB,KAAKuD,QAAQjI,KAAKyE,QAASzE,KAAKyE,QAASyD,SAAS+H,EAAO1M,OACzDvD,KAAKkN,iDAGE3I,GACPvE,KAAKuE,KAAOA,EACZQ,KAAKgD,IAAI/H,KAAK8E,OAAQP,EAAMA,EAAMA,GAClC2P,YAAY3I,kBC3FV4I,cACJ,SAAAA,EAAY7R,GAAO,IAAAwG,EAAA,OAAArM,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAAmU,GACjBrL,EAAArM,OAAAsM,EAAA,KAAAtM,CAAAuD,KAAAvD,OAAAuM,EAAA,KAAAvM,CAAA0X,GAAAvX,KAAAoD,KAAMsC,IACNwG,EAAKzH,KAAO,SACZyH,EAAKsL,GAAK9R,EAAM8R,IAAM,GACtBtL,EAAKuL,GAAwB,IAAlB/R,EAAM+R,IAAM,IACvBvL,EAAKwL,MAAQ,IACbxL,EAAKvE,KAAO,EACZuE,EAAKyL,SAAWJ,EAAOK,aACvB1L,EAAK2L,WAAa,IAClB3L,EAAKzE,MAAQ,IACbyE,EAAKG,OAVYH,4EAcjB,IAAI4L,EAAM1U,KAAK2U,YACX/W,EAAQoC,KAAK4U,WAGjB5U,KAAK6T,aAAe7T,KAAKwJ,kBAAkB,IAAI1D,aAAa4O,EAAIpM,UAAWzE,EAAOC,GAAG2F,aACrFzJ,KAAK+T,YAAc/T,KAAKwJ,kBAAkB,IAAIE,YAAY9L,EAAMiX,cAAehR,EAAOC,GAAG2F,aACzFzJ,KAAK8U,gBAAkB9U,KAAKwJ,kBAAkB,IAAIE,YAAY9L,EAAMmX,YAAalR,EAAOC,GAAG2F,aAC3FzJ,KAAKgV,oBAAsBhV,KAAKwJ,kBAAkB,IAAIE,YAAY9L,EAAMqX,iBAAkBpR,EAAOC,GAAG2F,aACpGzJ,KAAKkV,kBAAoBlV,KAAKwJ,kBAAkB,IAAIE,YAAY9L,EAAMuX,eAAgBtR,EAAOC,GAAG2F,6CAYhG,OAPA5F,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAGiC,aAAc/F,KAAK6T,cAClDhQ,EAAOC,GAAGiG,oBAAoBhG,EAAWiG,gBAAiB,EAAGnG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC5FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWmG,cAAe,EAAGrG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC1FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWO,MAAO,EAAGT,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAElFpG,EAAOC,GAAG8F,iBAAiB5F,EAAS6F,UAAU,EAAO7J,KAAKyE,SAC1DZ,EAAOC,GAAG8F,iBAAiB5F,EAAS8F,YAAY,EAAO9J,KAAK4E,WACpD5E,KAAKuU,UACX,KAAKJ,EAAOiB,UACVvR,EAAOC,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKyU,YACzC5Q,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAK8U,iBAC1DjR,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGuR,MAAOrV,KAAK8U,gBAAgB9O,SAAUnC,EAAOC,GAAGuG,eAAgB,GACjG,MACF,KAAK8J,EAAOmB,cACVzR,EAAOC,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKyU,YACzC5Q,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAKgV,qBAC1DnR,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGuR,MAAOrV,KAAKgV,oBAAoBhP,SAAUnC,EAAOC,GAAGuG,eAAgB,GAErGxG,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAKkV,mBAC1DrR,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGsG,UAAWpK,KAAKkV,kBAAkBlP,SAAUnC,EAAOC,GAAGuG,eAAgB,GACvG,MACF,KAAK8J,EAAOK,aACZ,QACE3Q,EAAOC,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKqE,OACzCR,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAK+T,aAC1DlQ,EAAOC,GAAGqG,aAAatG,EAAOC,GAAGsG,UAAWpK,KAAK+T,YAAY/N,SAAUnC,EAAOC,GAAGuG,eAAgB,GACjG,6CAIQC,GACZtK,KAAK2E,SAAW2F,GAAUtK,KAAK2E,SAC/BD,KAAK6F,IAAIvK,KAAK4E,UAAW5E,KAAK2E,SAAU3E,KAAKyE,yCAGvCF,GACNvE,KAAKuE,KAAOA,EAAOvE,KAAKsU,MACxBvP,KAAKgD,IAAI/H,KAAK8E,OAAQ9E,KAAKuE,KAAMvE,KAAKuE,KAAMvE,KAAKuE,MACjDG,KAAKsP,YAAYhU,KAAKyE,QAASzE,KAAK8E,QACpC9E,KAAKkN,oDAGKpO,GACVkB,KAAKuU,SAAWzV,mCAGTuF,GACPrE,KAAKqE,MAAQA,sCASb,IAGIjI,EAAGkB,EAAGiY,EAHNjN,EAAW,GACXzB,EAAS,GAMb,IAAKvJ,EAAI,EAAGA,GAAK0C,KAAKoU,GAAI9W,IACxB,IAAKlB,EAAI,EAAGA,GAAK4D,KAAKqU,GAAIjY,IAExBmZ,EAAIhN,EAAWL,EAAa,IAAJ9L,EAAU4D,KAAKqU,IAAKnM,EAAa,IAAJ5K,EAAU0C,KAAKoU,IAAKpU,KAAKuE,MAC9EsC,EAASA,EAAOC,OAAOyO,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAOzC,OAHA1O,EAASA,EAAOC,OAAO,CAAC,EAAG,EAAG,IAC9BwB,EAAWF,EAAYvB,EAAQ7G,KAAKsE,OAE7B,CACLgE,SAAYA,sCAMd,IAAIkN,EAAc,GACdC,EAAY,GACZC,EAAgB,GAChBC,EAAc,GACdvZ,EAAI,EAAGkB,EAAI,EAEf,IAAKA,EAAI,EAAGA,EAAI0C,KAAKoU,GAAI9W,IACvB,IAAKlB,EAAI,EAAGA,EAAI4D,KAAKqU,GAAK,EAAGjY,IAE3BqZ,EAAUjZ,KACRJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GACnBjY,EAAI,EAAIkB,GAAK0C,KAAKqU,GAAK,GACvBjY,EAAIkB,GAAK0C,KAAKqU,GAAK,GACnBjY,GAAKkB,EAAI,IAAM0C,KAAKqU,GAAK,IAI3BmB,EAAYhZ,KACVJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GACnBjY,EAAI,EAAIkB,GAAK0C,KAAKqU,GAAK,GACvBjY,EAAI,GAAKkB,EAAI,IAAM0C,KAAKqU,GAAK,IAE/BmB,EAAYhZ,KACVJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GACnBjY,EAAI,GAAKkB,EAAI,IAAM0C,KAAKqU,GAAK,GAC7BjY,GAAKkB,EAAI,IAAM0C,KAAKqU,GAAK,IAI/B,IAAKjY,EAAI,EAAGA,EAAI4D,KAAKqU,GAAK,EAAGjY,IAE3BkB,EAAI,EACJoY,EAAclZ,KAAKJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GAAIjY,EAAI,EAAIkB,GAAK0C,KAAKqU,GAAK,IACjE/W,EAAI,IAAO0C,KAAKoU,GAChBsB,EAAclZ,KAAKJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GAAIjY,EAAI,EAAIkB,GAAK0C,KAAKqU,GAAK,IACjE/W,EAAI,GAAM0C,KAAKoU,GACfsB,EAAclZ,KAAKJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GAAIjY,EAAI,EAAIkB,GAAK0C,KAAKqU,GAAK,IACjE/W,EAAI,IAAO0C,KAAKoU,GAChBsB,EAAclZ,KAAKJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GAAIjY,EAAI,EAAIkB,GAAK0C,KAAKqU,GAAK,IAEnE,IAAK/W,EAAI,EAAGA,EAAI0C,KAAKoU,GAAI9W,IACvBlB,EAAI4D,KAAKqU,GAAK,EACdqB,EAAclZ,KAAKJ,EAAIkB,GAAK0C,KAAKqU,GAAK,GAAIjY,GAAKkB,EAAI,IAAM0C,KAAKqU,GAAK,IAGrE,IAAK/W,EAAc,GAAV0C,KAAKoU,GAAU9W,EAAc,IAAV0C,KAAKoU,GAAW9W,IAE1CqY,EAAYnZ,MAAMwD,KAAKoU,GAAK,IAAMpU,KAAKqU,GAAK,IAC5CsB,EAAYnZ,KAAe,GAAVwD,KAAKqU,GAAW/W,GAAK0C,KAAKqU,GAAK,IAChDsB,EAAYnZ,KAAe,GAAVwD,KAAKqU,IAAY/W,EAAI,IAAM0C,KAAKqU,GAAK,IACtDsB,EAAYnZ,MAAMwD,KAAKoU,GAAK,IAAMpU,KAAKqU,GAAK,IAC5CsB,EAAYnZ,KAAe,GAAVwD,KAAKqU,IAAY/W,EAAI,IAAM0C,KAAKqU,GAAK,IACtDsB,EAAYnZ,KAAe,GAAVwD,KAAKqU,GAAW/W,GAAK0C,KAAKqU,GAAK,IAOlD,MAAO,CACLQ,aAAcW,EACdT,WAAYU,EACZR,gBAAiBS,EACjBP,cAAeQ,UA5KA1R,GAiLrBkQ,EAAOK,aAAe,EACtBL,EAAOiB,UAAY,EACnBjB,EAAOmB,cAAgB,MChKnBxR,ED0KE8R,cACJ,SAAAA,EAAYtT,GAAO,IAAAmO,EAAAhU,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAA4V,GACjBnF,EAAAhU,OAAAsM,EAAA,KAAAtM,CAAAuD,KAAAvD,OAAAuM,EAAA,KAAAvM,CAAAmZ,GAAAhZ,KAAAoD,KAAMsC,IACNmO,EAAK5I,IAAMvF,EAAMuF,KAAO,EACxB4I,EAAKvL,SAAU,EACf,IAAI2Q,EAAU,GAEVC,EAAQ,CAAC,EAAK,EAAK,GACnBC,EAAO,CAAC,EAAK,EAAK,GAClB3Z,EAAI,EAAGkB,EAAI,EAAGiY,EAAI,EAGtB,IAFAM,EAAQN,GAAK,IAAIS,EAAY,CAAE/O,IAAO,CAAC,EAAG,EAAGwJ,EAAK5I,KAAMvD,MAAOwR,EAAOhS,GAAID,EAAOC,KACjFyR,IACKnZ,EAAI,EAAGA,GAAK,EAAGA,IAClB,IAAKkB,EAAI,EAAGA,EAAI,EAAGA,IAEfuY,EAAQN,GAAK,IAAIS,EADT,IAAN5Z,GAAWkB,EAAI,IAAM,EACM,CAAE2J,IAAO,CAAW,IAAT7K,EAAI,GAAa,GAAJkB,EAAQmT,EAAK5I,KAAMvD,MAAOwR,EAAOhS,GAAID,EAAOC,IAGpE,CAAEmD,IAAO,CAAW,IAAT7K,EAAI,GAAa,GAAJkB,EAAQmT,EAAK5I,KAAMvD,MAAOyR,EAAMjS,GAAID,EAAOC,KAElGyR,IAnBa,OAsBjBM,EAAQN,GAAK,IAAIS,EAAY,CAAE/O,IAAO,CAAC,IAAQ,EAAGwJ,EAAK5I,KAAMvD,MAAOwR,EAAOhS,GAAID,EAAOC,KACtF2M,EAAKoF,QAAUA,EACfpF,EAAK2C,SAAS9Q,EAAMiC,MAAQ,GAC5BkM,EAAKxH,OAzBYwH,4EA8BjB,IAAIwF,EAAW,EACXpP,EAASJ,EAAYwP,EAAUjW,KAAKoE,MAAO,EAAa,EAAVuC,KAAKC,IACnD0B,EAAWF,EAAYvB,EAAQ7G,KAAKsE,MAAOuC,GAE3CzK,EAAI,EACJwB,EAAQ,GACZ,IAAKxB,EAAI,EAAGA,EAAI4D,KAAKoE,MAAQ,EAAGhI,IAC9BwB,EAAMpB,KAAKJ,GAEb4D,KAAK6T,aAAe7T,KAAKwJ,kBAAkB,IAAI1D,aAAawC,GAAWzE,EAAOC,GAAG2F,aACjFzJ,KAAK+T,YAAc/T,KAAKwJ,kBAAkB,IAAIE,YAAY9L,GAAQiG,EAAOC,GAAG2F,6CAI5E,GAAKzJ,KAAKkF,QAAV,CAGArB,EAAOC,GAAG6F,UAAU3F,EAASK,MAAOrE,KAAKqE,OACzCR,EAAOC,GAAG8P,UAAU5P,EAASuL,UAAW,GAExC1L,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAGiC,aAAc/F,KAAK6T,cAClDhQ,EAAOC,GAAGiG,oBAAoBhG,EAAWiG,gBAAiB,EAAGnG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,GAC5FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWmG,cAAe,EAAGrG,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAC1FpG,EAAOC,GAAGiG,oBAAoBhG,EAAWO,MAAO,EAAGT,EAAOC,GAAGmG,OAAO,EAAO,GAAO,IAElFpG,EAAOC,GAAGmC,WAAWpC,EAAOC,GAAG8B,qBAAsB5F,KAAK+T,aAE1D,IAAK,IAAI3X,EAAI,EAAGA,EAAI,GAAIA,IAGtByH,EAAOC,GAAG2L,WAAWzL,EAASwL,YAAaxP,KAAK6V,QAAQzZ,GAAGkI,OAC3DT,EAAOC,GAAG8F,iBAAiB5F,EAAS8F,YAAY,EAAO9J,KAAK6V,QAAQzZ,GAAGwI,WACvEf,EAAOC,GAAGqG,aAAanK,KAAK6V,QAAQzZ,GAAGmY,SAAUvU,KAAKoE,MAAOP,EAAOC,GAAGuG,eAAgB,GAEzFxG,EAAOC,GAAG8P,UAAU5P,EAASuL,UAAW,0CAG5BjF,GACZ,IAAK,IAAIlO,EAAI,EAAGA,EAAI,GAAIA,IACtB4D,KAAK6V,QAAQzZ,GAAG8Q,cAAc5C,kCAI3BzC,GACL7H,KAAK6H,IAAMA,EACX,IAAK,IAAIzL,EAAI,EAAGA,EAAI,GAAIA,IACtB4D,KAAK6V,QAAQzZ,GAAG8T,eAAelQ,KAAK6H,IAAM,qCAIrCtD,GAEP,IAAK,IAAInI,EAAI,EAAGA,EAAI,GAAIA,IACtB4D,KAAK6V,QAAQzZ,GAAGgX,SAAS7O,8CAIV0L,GACjB,IAAK,IAAI7T,EAAI,EAAGA,EAAI,GAAIA,IAEtB4D,KAAK6V,QAAQzZ,GAAG8Z,UAAUjG,UA3FRhM,GAwGlB+R,cACJ,SAAAA,EAAY1T,GAAO,IAAAwQ,EAAA,OAAArW,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAAgW,GACjBlD,EAAArW,OAAAsM,EAAA,KAAAtM,CAAAuD,KAAAvD,OAAAuM,EAAA,KAAAvM,CAAAuZ,GAAApZ,KAAAoD,KAAMsC,IACNwQ,EAAKzR,KAAO,eACM8C,IAAd7B,EAAM2E,MACR6L,EAAK5C,eAAe5N,EAAM2E,IAAI,GAAIiB,EAAS5F,EAAM2E,IAAI,IAAKiB,EAAS5F,EAAM2E,IAAI,KAC7E6L,EAAKqD,QAAQ7T,EAAM2E,IAAI,GAAI3E,EAAM2E,IAAI,KAEvC6L,EAAKsD,SAAU,EACftD,EAAKyB,SAAW1Q,EAAOC,GAAGuR,MARTvC,mFAYLxI,GACZtK,KAAK2E,SAAW2F,GAAUtK,KAAK2E,SAC/BD,KAAKyL,6BAA6BnQ,KAAKyE,QAASzE,KAAK6E,KAAM7E,KAAKiF,YAAajF,KAAK8E,QAClFJ,KAAK6F,IAAIvK,KAAK4E,UAAW5E,KAAK2E,SAAU3E,KAAKyE,gDAGhChG,EAAGkJ,EAAOa,QACTrE,IAAVwD,IACF3H,KAAK2H,MAAQA,QAGHxD,IAARqE,IACFxI,KAAKwI,IAAMA,GAGbxI,KAAKiF,YAAcsD,EAAWvI,KAAK2H,MAAO3H,KAAKwI,IAAK/J,GACpDuB,KAAKkN,gDAGC7B,EAASC,EAAO+K,GACtBxR,KAAKmL,UAAUhQ,KAAK6E,KAAM,EAAGwG,EAASC,GACtCtL,KAAKkN,iDAGE3I,GACPvE,KAAKuE,KAAOA,EACZvE,KAAK8E,OAASC,KAAKC,WAAWT,EAAMA,EAAMA,GAC1CvE,KAAKkN,kDAIGkD,GACR,GAAIzJ,KAAK2P,IAAIlG,EAAUzI,MAAQ3H,KAAK2H,OAAmB,IAAVhB,KAAKC,IAC7CD,KAAK2P,IAAIlG,EAAU5H,IAAMxI,KAAKwI,KAAiB,IAAV7B,KAAKC,GAAW,CACxD5G,KAAKoW,SAAU,EACf,IAAI7R,EAAwB,KAAjB6L,EAAU7L,KACrBQ,KAAKgD,IAAI/H,KAAK8E,OAAQP,EAAMA,EAAMA,GAClCvE,KAAKuW,YAAc,IAAIzQ,aAAa9F,KAAKsE,OACzCtE,KAAKsE,MAAQ,CAAC,EAAK,EAAK,GACxBtE,KAAKuU,SAAW1Q,EAAOC,GAAG0S,eACjBxW,KAAKoW,UACdpW,KAAKoW,SAAU,EACfrR,KAAKgD,IAAI/H,KAAK8E,OAAQ9E,KAAKuE,KAAMvE,KAAKuE,KAAMvE,KAAKuE,MACjDvE,KAAKsE,MAAQtE,KAAKuW,YAClBvW,KAAKuU,SAAW1Q,EAAOC,GAAGuR,OAE5BrV,KAAKkN,uBA3DiBjJ,GE3SXwS,GAAA,guCCAAC,GAAA,ktDF2BFC,GAAb,WACE,SAAAA,EAAYC,GAAQna,OAAAyH,EAAA,KAAAzH,CAAAuD,KAAA2W,GAClB7S,EAAM8S,EAAOC,WAAW,QACtB,CAAEC,OAAO,EAAMC,UAAU,IAE3BlT,EAAOC,GAAKA,EAEZ,IAAIkT,EAAQ,IAAItL,EAAM,CAAC5H,OACvB9D,KAAKgX,MAAQA,EACbA,EAAMC,YAAY/I,GAAYC,IAC9BnO,KAAKS,OAAS,IAAI+J,EAAO,CAAC5J,OAAQ,IAAKD,MAAO,MAC9CqW,EAAME,UAAUlX,KAAKS,QAErBT,KAAKmX,MAAQ,IAAItO,EAAM,CAAC/E,OACxBkT,EAAMI,IAAIpX,KAAKmX,OAEf,IAAIjD,EAAc,IAAIxE,EAAY,CAAC5L,KAAIQ,MAAO,CAAC,EAAK,GAAK,MAEzDtE,KAAKkU,YAAcA,EACnB8C,EAAMI,IAAIlD,GACV,IAAImD,EAAa,IAAI7G,EAAW,CAAC1M,OACjC9D,KAAKqX,WAAaA,EAClBL,EAAMI,IAAIpX,KAAKqX,YACfrX,KAAKsX,OAAS,IAAInD,EAAO,CAACrQ,OAC1BkT,EAAMI,IAAIpX,KAAKsX,QACf,IAAIC,EAAc,IAAI1E,EAAY,CAAC/O,OACnC9D,KAAKuX,YAAcA,EAEnBP,EAAMI,IAAIpX,KAAKuX,aACf,IAAIC,EAAY,IAAI5B,EAAU,CAAC9R,OAC/B9D,KAAKwX,UAAYA,EACjBR,EAAMI,IAAIpX,KAAKwX,WACftD,EAAYuD,iBAAiB,SAAUxH,GACrCoH,EAAWK,mBAAoBzH,GAC/BsH,EAAYG,mBAAmBzH,GAC/BuH,EAAUE,mBAAoBzH,KAIhC+G,EAAMW,SAvCV,OAAAlb,OAAAmb,EAAA,KAAAnb,CAAAka,EAAA,EAAAzX,IAAA,QAAAN,MAAA,WA4CIsV,YAAY2D,QACZR,WAAWS,eACXrX,OAAOoX,UA9CX,CAAA3Y,IAAA,eAAAN,MAAA,SAiDe0D,QACO6B,IAAdqT,YACFA,UAAY,IAAI5B,EAAUtT,GAC1B4R,YAAYuD,iBAAiB,SAAUxH,GACrCuH,UAAUE,mBAAmBzH,KAE/BiE,YAAY3I,SACZyL,MAAMI,IAAII,WAAW,MAxD3B,CAAAtY,IAAA,WAAAN,MAAA,SA4DW0D,QACO6B,IAAV4T,QACFA,MAAQ,IAAI7E,EAAM5Q,GAClB4R,YAAYuD,iBAAiB,SAAUxH,GACrC8H,MAAMC,YAAY/H,KAEpBiE,YAAY3I,SACZyL,MAAMI,IAAIW,OAAO,MAnEvB,CAAA7Y,IAAA,eAAAN,MAAA,SAuEegY,EAAQlE,GACnB5O,EAAK8S,EAAOC,WAAW,WACrB,CAAEC,OAAO,EAAMC,UAAU,IAEpBH,EAAOC,WAAW,MAEzBG,MAAQ,IAAItL,EACZjL,OAAS,IAAI+J,EACbyN,WAAa,IAAIpP,EACjBqL,YAAc,IAAIxE,EAAY,CAAEpL,MAAO,CAAC,GAAK,GAAK,OAClD4P,YAAYd,SAAS,IACrBiE,WAAa,IAAI7G,EAAW,CAAElM,MAAO,CAAC,GAAK,GAAK,IAAMC,KAAM,KAC5D2P,YAAYuD,iBAAiB,SAAUxH,GACrCoH,WAAWK,mBAAmBzH,KAGhCsH,YAAc,IAAI1E,EAElBqB,YAAYuD,iBAAiB,SAAUxH,GACrCsH,YAAYG,mBAAmBzH,KAEjCqH,OAAS,IAAIY,KAAK,CAChB5T,MAAO,CAAC,IAAM,GAAK,IACnB8P,GAAI,GACJC,GAAI,KAGNH,YAAY3D,SAAS,CAAE1I,IAAK,EAAGvE,MAAO,EAAGC,KAAM,EAAGF,QAAS,IAG3D2T,MAAMI,IAAIa,YACVjB,MAAMI,IAAIlD,aACV8C,MAAMI,IAAIC,YACVL,MAAMI,IAAIG,aACVP,MAAMI,IAAIE,QACVN,MAAMI,IAAI3W,UA1Gd,CAAAvB,IAAA,UAAAN,MAAA,SA6GUgY,GACN,IAAIuB,EAAavB,EAAOwB,iBACpBC,EAAezB,EAAOjW,MAAQwX,EAC9BG,EAAgB1B,EAAOhW,OAASuX,EAEhCE,IAAiB5X,OAAOE,OAAS2X,IAAkB7X,OAAOG,QAC5DH,OAAOyK,QAAQmN,EAAcC,GAE/BtB,MAAMW,WArHV,CAAAzY,IAAA,WAAAN,MAAA,SAwHWgY,GACP,IAAIuB,EAAavB,EAAOwB,iBACxBxB,EAAO2B,UAAYC,GAAGjU,KAAKqS,EAAOjW,MAAQwX,EAAYvB,EAAOhW,OAASuX,OA1H1ExB,EAAA,GA0KAlX,OAAOkX,UAAYA,GACJ,IG7Kf8B,GAAA,CACAta,KAAA,MACAua,WAAA,CACAC,SAAA/V,EACAgW,aAAA1V,EACA2V,YAAAjV,GAEA9H,KAPA,WAQA,OACA2E,OAAA,KAIAqY,QAbA,aAiBAC,QAjBA,WAkBAhM,QAAAC,IAAA,WACAhN,KAAAgZ,UAAA,IAAAC,GAAAjZ,KAAAkZ,MAAAtC,QACA5W,KAAAS,OAAAT,KAAAgZ,UAAAvY,QAEA8B,QAAA,CACAvB,kBADA,SACAmY,GACA,WAAAA,EAAAja,IACAc,KAAAgZ,UAAA9E,YAAA3D,SAAA,CAAAlN,QAAA+V,IAAAD,EAAAva,SACA,SAAAua,EAAAja,IACAc,KAAAgZ,UAAA9E,YAAA3D,SAAA,CAAAjN,MAAA8V,IAAAD,EAAAva,SACA,QAAAua,EAAAja,KACAc,KAAAgZ,UAAA9E,YAAA3D,SAAA,CAAAhN,KAAA6V,IAAAD,EAAAva,YCtD8Tya,GAAA,GCQ1TC,cAAY7c,OAAAkG,EAAA,KAAAlG,CACd4c,GACAvZ,EACAmB,GACF,EACA,KACA,KACA,OAIesY,GAAAD,uDCbfE,OAAIC,IAAIC,MAERF,OAAIG,OAAOC,eAAgB,EAE3B,IAAIJ,OAAI,CACN7B,OAAQ,SAAAkC,GAAC,OAAIA,EAAEN,OACdO,OAAO","file":"js/index.411704d7.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"index\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-container',{attrs:{\"fluid\":\"\",\"id\":\"app\"}},[_c('b-row',[_c('b-col',{attrs:{\"cols\":\"2\"}},[_c('c-sidebar',{attrs:{\"camera\":_vm.camera}}),_c('c-information')],1),_c('b-col',{attrs:{\"cols\":\"10\"}},[_c('canvas',{ref:\"canvas\",attrs:{\"width\":\"800\",\"height\":\"600\"}})]),_c('b-col',{attrs:{\"cols\":\"3\"}},[_c('c-debug-panel',{on:{\"valueChanged\":function($event){return _vm.debugValueChanged($event)}}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"camera\"},[_c('div',[_vm._v(\"摄像机θ角(与Z轴正半轴夹角)\\r\\n      \"),_c('b-form-input',{attrs:{\"type\":\"range\",\"id\":\"cameraTheta\",\"min\":\"0\",\"max\":\"180\"},on:{\"change\":_vm.cameraThetaChanged},model:{value:(_vm.cameraTheta),callback:function ($$v) {_vm.cameraTheta=$$v},expression:\"cameraTheta\"}})],1),_c('div',[_vm._v(\"摄像机φ角(与X轴正半轴夹角)\\r\\n      \"),_c('b-form-input',{attrs:{\"type\":\"range\",\"id\":\"cameraPhi\",\"min\":\"0\",\"max\":\"360\"},on:{\"change\":_vm.cameraPhiChanged},model:{value:(_vm.cameraPhi),callback:function ($$v) {_vm.cameraPhi=$$v},expression:\"cameraPhi\"}})],1),_c('div',[_vm._v(\"摄像机距原点\\r\\n      \"),_c('b-form-input',{attrs:{\"type\":\"range\",\"id\":\"cameraDis\",\"min\":\"1\",\"max\":\"180\"},on:{\"change\":_vm.cameraDisChanged},model:{value:(_vm.cameraDis),callback:function ($$v) {_vm.cameraDis=$$v},expression:\"cameraDis\"}})],1)]),_vm._m(0),_vm._m(1),_vm._m(2),_vm._m(3)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"params\"},[_c('div',[_vm._v(\"参考球半径\")]),_c('div',[_vm._v(\"球面透明度\")]),_c('div',[_vm._v(\"指示器大小\")]),_c('div',[_vm._v(\"轨迹宽度\")]),_c('div',[_vm._v(\"模拟器大小\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sphereMode\"},[_c('div',[_vm._v(\"Line\")]),_c('div',[_vm._v(\"Surface\")]),_c('div',[_vm._v(\"lessLine\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"option\"},[_c('div',[_vm._v(\"绘制路径\")]),_c('div',[_vm._v(\"绘制模拟器\")]),_c('div',[_vm._v(\"球坐标系\")]),_c('div',[_vm._v(\"显示修正圆圈\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"action\"},[_c('div',[_vm._v(\"重置摄像机\")]),_c('div',[_vm._v(\"重置路径\")]),_c('div',[_vm._v(\"打点\")]),_c('div',[_vm._v(\"重置打点\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n<div>\r\n  <div class=\"camera\">\r\n    <div>摄像机θ角(与Z轴正半轴夹角)\r\n      <b-form-input type=\"range\" id=\"cameraTheta\" v-model=\"cameraTheta\" min=\"0\" max=\"180\" @change=\"cameraThetaChanged\"/>\r\n    </div>\r\n    <div>摄像机φ角(与X轴正半轴夹角)\r\n      <b-form-input type=\"range\" id=\"cameraPhi\" v-model=\"cameraPhi\" min=\"0\" max=\"360\" @change=\"cameraPhiChanged\" />\r\n    </div>\r\n    <div>摄像机距原点\r\n      <b-form-input type=\"range\" id=\"cameraDis\" v-model=\"cameraDis\" min=\"1\" max=\"180\" @change=\"cameraDisChanged\" />\r\n    </div>\r\n  </div>\r\n  <div class=\"params\"> \r\n    <div>参考球半径</div>\r\n    <div>球面透明度</div>\r\n    <div>指示器大小</div>\r\n    <div>轨迹宽度</div>\r\n    <div>模拟器大小</div>\r\n  </div>\r\n  <div class=\"sphereMode\">\r\n    <div>Line</div>\r\n    <div>Surface</div>\r\n    <div>lessLine</div>\r\n  </div>\r\n  <div class=\"option\">\r\n    <div>绘制路径</div>\r\n    <div>绘制模拟器</div>\r\n    <div>球坐标系</div>\r\n    <div>显示修正圆圈</div>\r\n  </div>\r\n  <div class=\"action\">\r\n    <div>重置摄像机</div>\r\n    <div>重置路径</div>\r\n    <div>打点</div>\r\n    <div>重置打点</div>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    camera: Object\r\n  },\r\n  data() {\r\n    return {\r\n      cameraTheta: 0,\r\n      cameraPhi: 0,\r\n      cameraDis: 0,\r\n    }\r\n  },\r\n  methods: {\r\n    cameraPhiChanged() {\r\n      this.camera.rotate(null, this.cameraPhi, null);\r\n    },\r\n    cameraThetaChanged() {\r\n      this.camera.rotate(this.cameraTheta, null, null);\r\n    },\r\n    cameraDisChanged() {\r\n      this.camera.rotate(null, null, this.cameraDis);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sidebar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sidebar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Sidebar.vue?vue&type=template&id=9029acaa&\"\nimport script from \"./Sidebar.vue?vue&type=script&lang=js&\"\nexport * from \"./Sidebar.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',[_vm._v(\"Picth\")]),_c('div',[_vm._v(\"Roll\")]),_c('div',[_vm._v(\"Heading\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n<div>\r\n  <div>Picth</div>\r\n  <div>Roll</div>\r\n  <div>Heading</div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Information.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Information.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Information.vue?vue&type=template&id=7f9ab7d8&\"\nimport script from \"./Information.vue?vue&type=script&lang=js&\"\nexport * from \"./Information.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',[_vm._v(\"Heading\\n    \"),_c('b-form-input',{attrs:{\"type\":\"range\",\"id\":\"heading\",\"min\":\"0\",\"max\":\"360\"},on:{\"change\":function($event){return _vm.$emit('valueChanged', {'key': 'heading', 'value': _vm.heading})}},model:{value:(_vm.heading),callback:function ($$v) {_vm.heading=$$v},expression:\"heading\"}})],1),_c('div',[_vm._v(\"Picth\\n    \"),_c('b-form-input',{attrs:{\"type\":\"range\",\"id\":\"pitch\",\"min\":\"-90\",\"max\":\"90\"},on:{\"change\":function($event){return _vm.$emit('valueChanged', {'key': 'pitch', 'value': _vm.pitch})}},model:{value:(_vm.pitch),callback:function ($$v) {_vm.pitch=$$v},expression:\"pitch\"}})],1),_c('div',[_vm._v(\"Roll\\n    \"),_c('b-form-input',{attrs:{\"type\":\"range\",\"id\":\"roll\",\"min\":\"0\",\"max\":\"180\"},on:{\"change\":function($event){return _vm.$emit('valueChanged', {'key': 'roll', 'value': _vm.roll})}},model:{value:(_vm.roll),callback:function ($$v) {_vm.roll=$$v},expression:\"roll\"}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div>Heading\r\n      <b-form-input type=\"range\" id=\"heading\" v-model=\"heading\" min=\"0\" max=\"360\" \r\n        @change=\"$emit('valueChanged', {'key': 'heading', 'value': heading})\" />\r\n    </div>\r\n    <div>Picth\r\n      <b-form-input type=\"range\" id=\"pitch\" v-model=\"pitch\" min=\"-90\" max=\"90\"\r\n        @change=\"$emit('valueChanged', {'key': 'pitch', 'value': pitch})\"/>\r\n    </div>\r\n    <div>Roll\r\n      <b-form-input type=\"range\" id=\"roll\" v-model=\"roll\" min=\"0\" max=\"180\"\r\n        @change=\"$emit('valueChanged', {'key': 'roll', 'value': roll})\"/>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      heading: 0,\r\n      pitch: 0,\r\n      roll: 0,\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DebugPanel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DebugPanel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DebugPanel.vue?vue&type=template&id=7a4552b7&\"\nimport script from \"./DebugPanel.vue?vue&type=script&lang=js&\"\nexport * from \"./DebugPanel.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var states = {\r\n  gl: \"not initialized\",\r\n};\r\n\r\nvar attributes = {};  // attribute variables from shader\r\nvar uniforms = {};    // uniform variables from shader\r\nexport {states, uniforms, attributes};","import {states} from './Variables'\r\n/**\r\n* 所有需要绘制的对象在构造时需要调用此函数对参数进行初始化\r\n**/\r\nclass PaintObj {\r\n  constructor(props) {\r\n    if (props === undefined) {\r\n      props = {};\r\n    }\r\n    this.sides = props.sides || 24;\r\n    this.alpha = props.alpha || 1.0;\r\n    this.color = props.color || [0.8, 0.8, 0.8];\r\n    this.size = props.size || 1.0;\r\n    this.gl = props.gl;\r\n    this.buffers = {};\r\n    this.mMatrix = mat4.create();\r\n    this.pvMatrix = mat4.create();\r\n    this.mvpMatrix = mat4.create();\r\n    this.quat = quat.create();\r\n    this.vscale = vec3.fromValues(1.0, 1.0, 1.0); // vec3.create equals to fromValues(0.0, 0.0, 0.0)\r\n    this.translation = vec3.create();\r\n    this.visible = true;\r\n    this._x = 0;\r\n    this._y = 0;\r\n    this._z = 0;\r\n    this._rotateX = 0;\r\n    this._rotateY = 0;\r\n    this._rotateZ = 0;\r\n  }\r\n\r\n  /**\r\n  * @param {*} data  数组或 long 型整数\r\n  * @param {*} drawtype  STATIC or DYNAMIC\r\n  * @param {*} type  ELEMENT or ARRAY\r\n  */\r\n  createArrayBuffer(data, drawtype, type) {\r\n    var buffer = states.gl.createBuffer();\r\n\r\n    if (type === undefined) {\r\n      type = states.gl.ELEMENT_ARRAY_BUFFER;\r\n      buffer.itemSize = data.itemSize || 1;\r\n      if (data instanceof Float32Array) {\r\n        type = states.gl.ARRAY_BUFFER;\r\n        buffer.itemSize = data.itemSize || 3;\r\n      }\r\n      buffer.numItems = data.length / buffer.itemSize;\r\n    }\r\n\r\n    states.gl.bindBuffer(type, buffer);\r\n    states.gl.bufferData(type, data, drawtype);\r\n    states.gl.bindBuffer(type, null);\r\n    return buffer;\r\n  }\r\n\r\n  \r\n  subBuffer(buffer, offset, data) {\r\n    var type = states.gl.ELEMENT_ARRAY_BUFFER;\r\n    if (data instanceof Float32Array) {\r\n      type = states.gl.ARRAY_BUFFER;\r\n    }\r\n\r\n    states.gl.bindBuffer(type, buffer);\r\n    states.gl.bufferSubData(type, offset, data);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n* 计算出圆柱体需要的顶点和索引\r\n**/\r\nfunction cylinderShape(radius, segment, height) {\r\n  var bottom = circleShape(radius, segment);\r\n  var upper = circleShape(radius, segment, 0, Math.PI * 2, height);\r\n  var vertex = bottom.concat(upper);\r\n\r\n  var index = [];\r\n  var i = 0;\r\n  // bottom\r\n  for (i = 1; i < segment; i++) {\r\n    index.push(0, i + 1, i);\r\n  }\r\n  index.push(0, 1, i);\r\n\r\n  // upper\r\n  for (i = segment + 2; i < 2 * segment + 1; i++) {\r\n    index.push(segment + 1, i, i + 1);\r\n  }\r\n  index.push(segment + 1, i, segment + 2);\r\n\r\n  // side\r\n  for (i = 1; i < segment; i++) {\r\n    index.push(segment + 1 + i, i, i + 1);\r\n    index.push(segment + i + 1, i + 1, segment + i + 2);\r\n  }\r\n  index.push(segment + 1 + i, i, 1);\r\n  index.push(segment + i + 1, 1, segment + 2);\r\n\r\n  return {\r\n    vertex: vertex,\r\n    index: index\r\n  }\r\n}\r\n\r\n/**\r\n* calculate circle on the plane xoy with given sides and distance between each vertex and origin point\r\n* Note that the origin point is the first element of the array and\r\n* the direction of the circle is anti-clock viewed from Z+ to Z-\r\n*\r\n* @return vertex.size = (segment+1) * 3\r\n*/\r\nfunction circleShape(radius, segment, thetaStart, thetaEnd, pos) {\r\n  var vertex = [];\r\n  var x = 0.0;\r\n  var y = 0.0;\r\n  var z = pos || 0.0;\r\n  var start = thetaStart || 0;\r\n  var end = thetaEnd || Math.PI * 2;\r\n\r\n  var dtheta = (end - start) / segment;\r\n  vertex = vertex.concat([x, y, 0.0]);\r\n  for (var i = 0; i < segment; i++) {\r\n    x = Math.cos(i * dtheta + start) * radius;\r\n    y = Math.sin(i * dtheta + start) * radius;\r\n    vertex = vertex.concat([x, y, z]);\r\n  }\r\n  return vertex;\r\n}\r\n\r\n\r\n\r\n/**\r\n*  @param {Array} vertex  the vertices to rotate around the origin point\r\n*  @param {Number}   theta is in terms of RAD\r\n*  @param {Number}   beta  is in terms of RAD\r\n*  @desc 将所有顶点按照世界坐标轴 Y 轴，Z 轴依次进行 theta 角和 beta 角的旋转\r\n**/\r\nfunction rotateVertex(vertex, theta, beta, dis) {\r\n  var v = vec3.create();\r\n  var d = dis || 0;\r\n  for (var i = 0; i < vertex.length; i += 3) {\r\n    vec3.set(v, vertex[i + 0], vertex[i + 1], vertex[i + 2] + d);\r\n    vec3.rotateY(v, v, [0, 0, 0], theta);\r\n    vec3.rotateZ(v, v, [0, 0, 0], beta);\r\n    vertex[i + 0] = v[0];\r\n    vertex[i + 1] = v[1];\r\n    vertex[i + 2] = v[2];\r\n  }\r\n  //    return vertex;\r\n}\r\n\r\n\r\nfunction degToRad(deg) {\r\n  return deg * Math.PI / 180;\r\n}\r\n\r\n\r\n/**\r\n* 用更紧凑的方式得到顶点信息的数组，\r\n* 认为每 9 个数据表示一个顶点、颜色和法向量数据，\r\n* 可根据 color，normal 的长度自动进行颜色的复制\r\n**/\r\nfunction genVertices(vertex, color, normal) {\r\n  var vertices = [];\r\n  var i = 0;\r\n  if (color.length <= 3) {\r\n    if (normal === undefined) {\r\n      for (i = 0; i < vertex.length; i += 3) {\r\n        vertices = vertices.concat(vertex[i], vertex[i + 1], vertex[i + 2]);\r\n        vertices = vertices.concat(color[0], color[1], color[2]);\r\n      }\r\n    } else if (normal.length <= 3) {\r\n      for (i = 0; i < vertex.length; i += 3) {\r\n        vertices = vertices.concat(vertex[i], vertex[i + 1], vertex[i + 2]);\r\n        vertices = vertices.concat(color[0], color[1], color[2]);\r\n        vertices = vertices.concat(normal[0], normal[1], normal[2]);\r\n      }\r\n    } else {\r\n      for (i = 0; i < vertex.length; i += 3) {\r\n        vertices = vertices.concat(vertex[i], vertex[i + 1], vertex[i + 2]);\r\n        vertices = vertices.concat(color[0], color[1], color[2]);\r\n        vertices = vertices.concat(normal[i], normal[i + 1], normal[i + 2]);\r\n      }\r\n    }\r\n  } else {\r\n    if (normal === undefined) {\r\n      for (i = 0; i < vertex.length; i += 3) {\r\n        vertices = vertices.concat(vertex[i], vertex[i + 1], vertex[i + 2]);\r\n        vertices = vertices.concat(color[i], color[i + 1], color[i + 2]);\r\n      }\r\n    } else if (normal.length <= 3) {\r\n      for (i = 0; i < vertex.length; i += 3) {\r\n        vertices = vertices.concat(vertex[i], vertex[i + 1], vertex[i + 2]);\r\n        vertices = vertices.concat(color[i], color[i + 1], color[i + 2]);\r\n        vertices = vertices.concat(normal[0], normal[1], normal[2]);\r\n      }\r\n    } else {\r\n      for (i = 0; i < vertex.length; i += 3) {\r\n        vertices = vertices.concat(vertex[i], vertex[i + 1], vertex[i + 2]);\r\n        vertices = vertices.concat(color[i], color[i + 1], color[i + 2]);\r\n        vertices = vertices.concat(normal[i], normal[i + 1], normal[i + 2]);\r\n      }\r\n    }\r\n  }\r\n\r\n  return vertices;\r\n}\r\n\r\n\r\n/**\r\n* 假设球心即为原点，将球极坐标系转换成平面直角坐标系\r\n* @param   theta {Numer}    Rad 弧度制，球心到顶点的连线与 Z 轴正方向的夹角为 theta\r\n* @param   phi  {Numer}    Rad 弧度制，球心到顶点的连线在 xoy 平面上的投影与 X 轴正方向的夹角为 phi\r\n* @param   r     {Number}  球半径\r\n* @return  {vec3}    顶点的坐标，表示\r\n*/\r\nfunction coordCarte(theta, phi, r) {\r\n  var st = Math.sin(theta);\r\n  var ct = Math.cos(theta);\r\n  var sp = Math.sin(phi);\r\n  var cp = Math.cos(phi);\r\n  var x = r * st * cp;\r\n  var y = r * st * sp;\r\n  var z = r * ct;\r\n  // return [x, y, z]\r\n  return vec3.fromValues(x, y, z);\r\n}\r\n\r\nexport {PaintObj, cylinderShape, circleShape, rotateVertex, degToRad, genVertices,\r\n  coordCarte\r\n};","import {PaintObj, cylinderShape, rotateVertex, degToRad, genVertices} from './PaintObj'\r\nimport {states, uniforms, attributes} from './Variables'\r\n/**\r\n* Coord Object\r\n* 用于绘制坐标轴\r\n**/\r\nclass Coord extends PaintObj {\r\n  constructor(props) {\r\n    super(props);\r\n    this.type = \"Coord\";\r\n    this.length = 10.0;\r\n    this.init();\r\n  }\r\n  \r\n  init() {\r\n    var xcoord = cylinderShape(0.01, this.sides, this.length);\r\n    rotateVertex(xcoord.vertex, degToRad(90), 0);\r\n    var xvertices = genVertices(xcoord.vertex, [0.9, 0.1, 0.0], [1.0, 1.0, 1.0]);\r\n\r\n    var ycoord = cylinderShape(0.01, this.sides, this.length);\r\n    rotateVertex(ycoord.vertex, degToRad(90), degToRad(90));\r\n    var yvertices = genVertices(ycoord.vertex, [0.0, 0.9, 0.0], [1.0, 1.0, 1.0]);\r\n\r\n    var zcoord = cylinderShape(0.01, this.sides, this.length);\r\n    var zvertices = genVertices(zcoord.vertex, [0.0, 0.0, 0.9], [1.0, 1.0, 1.0]);\r\n\r\n    var vertices = [];\r\n    vertices = vertices.concat(xvertices);\r\n    vertices = vertices.concat(yvertices);\r\n    vertices = vertices.concat(zvertices);\r\n\r\n    var index = [];\r\n    index = index.concat(xcoord.index);\r\n    //        index = index.concat( ycoord.index );\r\n    var length = 2 * this.sides + 2;\r\n    for (var i = 0; i < ycoord.index.length; i++) {\r\n      index.push(length + ycoord.index[i]);\r\n    }\r\n    //        index = index.concat( zcoord.index );\r\n    length = 4 * this.sides + 4;\r\n    for (var i = 0; i < zcoord.index.length; i++) {\r\n      index.push(length + zcoord.index[i]);\r\n    }\r\n    this.buffers.vertex = this.createArrayBuffer(new Float32Array(vertices), states.gl.STATIC_DRAW);\r\n    this.buffers.index = this.createArrayBuffer(new Uint16Array(index), states.gl.STATIC_DRAW);\r\n    this.buffers.index.numItems = index.length;\r\n  }\r\n\r\n  paint() {\r\n    states.gl.uniform1f(uniforms.alpha, this.alpha);\r\n    states.gl.uniformMatrix4fv(uniforms.m_matrix, false, this.mMatrix);\r\n    states.gl.uniformMatrix4fv(uniforms.pmv_matrix, false, this.mvpMatrix);\r\n    // console.log(\"Coord\", this)\r\n    states.gl.bindBuffer(states.gl.ARRAY_BUFFER, this.buffers.vertex);\r\n    states.gl.vertexAttribPointer(attributes.vertex_position, 3, states.gl.FLOAT, false, 9 * 4, 0);\r\n    states.gl.vertexAttribPointer(attributes.color, 3, states.gl.FLOAT, false, 9 * 4, 3 * 4);\r\n    states.gl.vertexAttribPointer(attributes.vertex_normal, 3, states.gl.FLOAT, false, 9 * 4, 6 * 4);\r\n    states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.buffers.index);\r\n    states.gl.drawElements(states.gl.TRIANGLES, this.buffers.index.numItems, states.gl.UNSIGNED_SHORT, 0);\r\n  }\r\n\r\n  onViewChanged(matrix) {\r\n    this.pvMatrix = matrix || this.pvMatrix;\r\n    mat4.mul(this.mvpMatrix, this.pvMatrix, this.mMatrix);\r\n    // this.paint()\r\n  }\r\n}\r\n// end of Coord prototype\r\n\r\nexport default Coord","import {states, attributes, uniforms} from './Variables'\r\nimport {coordCarte, degToRad} from './PaintObj'\r\n\r\n/**\r\n* @class Camera\r\n* @desc  透视角度摄像机，通过该类控制视窗变化\r\n*    设置 pos 改变摄像机的位置\r\n*    设置 up  改变摄像机的上方向\r\n*    设置 lookat 改变摄像机的视点\r\n* 摄像机对象维护 pvMatrix，并会在视图矩阵更新时通知相关联的 watcher 对象，\r\n* 若没有设置 watcher 对象则不会更新视图。\r\n* 默认摄像机的 lookat 一直是 [0, 0, 0] 原点，up 是 Z 轴方向\r\n**/\r\nclass Camera {\r\n  defaultTheta = 45\r\n  defaultPhi = 45\r\n  defaultDis = 15\r\n  defaultViewWidth = 800\r\n  defaultViewHeight = 600\r\n\r\n  constructor(props) {\r\n    //    PaintObj.call( this );\r\n    this.type = \"Camera\";\r\n    \r\n    this.theta = props.theta || this.defaultTheta;\r\n    this.theta = degToRad(this.theta);\r\n    this.phi = props.phi || this.defaultPhi;\r\n    this.phi = degToRad(this.phi);\r\n    this.dis = props.dis || this.defaultDis;\r\n\r\n    this.width = props.width || this.defaultViewWidth;\r\n    this.height = props.height || this.defaultViewHeight;\r\n    this.pos = coordCarte(this.theta, this.phi, this.dis);\r\n    this.up = vec3.fromValues(0, 0, 1);\r\n    this.lookat = vec3.fromValues(0, 0, 0);\r\n    this.pMatrix = mat4.create();\r\n    this.vMatrix = mat4.create();\r\n    this.pvMatrix = mat4.create();\r\n    \r\n    this.setSize(this.width, this.height);\r\n  }\r\n\r\n  /**\r\n    * @desc 更新视图矩阵并通知 watcher 对象 pvMatrix 已更新\r\n  **/\r\n  update() {\r\n    mat4.lookAt(this.vMatrix, this.pos, this.lookat, this.up);\r\n    mat4.mul(this.pvMatrix, this.pMatrix, this.vMatrix);\r\n    if (this.watcher !== undefined) {\r\n      this.watcher(this.pvMatrix);\r\n    }\r\n  }\r\n\r\n  /**\r\n  * 设置 watcher 对象\r\n  **/\r\n  recv(watcher) {\r\n    this.watcher = watcher;\r\n  }\r\n\r\n  /**\r\n  * 设置摄像机的旋转操作\r\n  * @param a_theta  用角度制表示的 theta 角，与 Z 轴正半轴的夹角,\r\n  *   [0, 180]，为了便于区分参数中的角度制和弧度制，在变量名前加 a 表示角度制\r\n  * @param a_phi 用角度制表示的 phi 角， 与 X 轴正半轴的夹角，[0, 360]\r\n  * @param r  到原点的距离\r\n  * @note  some problem occurred when x or y equals to zero\r\n  *    because you can't set up [0, 0, 1] and look at [0, 0, 0] the origin point.\r\n  **/\r\n  rotate(a_theta, a_phi, r) {\r\n    if(a_theta) {\r\n      if (a_theta < 0.01) {\r\n        a_theta = 0.01;\r\n      } else if (a_theta > 179.99) {\r\n        a_theta = 179.99;\r\n      }\r\n      this.theta = degToRad(a_theta);\r\n    }\r\n    if(a_phi) {\r\n      this.phi = degToRad(a_phi);\r\n    }\r\n    if(r) {\r\n      this.dis = r;\r\n    }\r\n    /**\r\n     * 当 POS 距离 图像超过 1 时，无法显示\r\n     */\r\n    // this.pos = [0.65, 0.65, 0.65]\r\n    this.pos = coordCarte(this.theta, this.phi, this.dis);\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n  * 设置 gl 的视口，并更新透视矩阵和视图矩阵\r\n  **/\r\n  setSize(width, height) {\r\n    this.width = width;\r\n    this.height = height;\r\n    states.gl.viewport(0, 0, width, height);\r\n    mat4.perspective(this.pMatrix, 45 / 180 * Math.PI, width / height, 0.5, 500.0);\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n  * 重置摄像机位置\r\n  **/\r\n  reset() {\r\n    this.rotate(this.defaultTheta, this.defaultPhi, this.dis);\r\n    this.update();\r\n  }\r\n}\r\n\r\n\r\n\r\n/**\r\n* @desc 场景控制器\r\n* 1. 封装了对 gl 的设置，若无必要，不用再设置 gl；异步加载着色器代码，封装了对着色器的编译连接等操作。\r\n* 包含对全局变量 attributes 和 uniforms 的设置\r\n* 2. 为了方便，实际上将 Renderer 的功能集成到了 Scene 中，需要绘制时，调用 Scene 对象的 render 方法即可。\r\n* 3. 场景只能接收一个 Camera 对象，若多次添加 Camera 对象，则会将最后一个 Camera 对象设为当前的 Camera 对象\r\n**/\r\nclass Scene {\r\n  /**\r\n   * \r\n   * @param {Object} props \r\n   */\r\n  constructor(props) {\r\n    let gl = states.gl;\r\n    // states.gl = gl;\r\n    gl.enable(gl.DEPTH_TEST); // depth test\r\n    gl.depthFunc(gl.LESS);\r\n    gl.enable(gl.CULL_FACE); // 设置遮挡剔除有效\r\n    gl.cullFace(gl.BACK);\r\n    gl.clearColor(0.97, 0.97, 0.97, 1.0); // background color\r\n    gl.clearDepth(1.0);\r\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\r\n    gl.enable(gl.BLEND); // enable blend for alpha\r\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n    this.type = \"Scene\";\r\n    this.objs = [];\r\n    this.light_direct = [0.35, 0.35, 0.7];\r\n  }\r\n\r\n\r\n  /**\r\n    * @params first  将物体添加到序列头部，每次绘制时优先绘制\r\n    * @desc 添加要绘制的物体。不包含摄像机\r\n  **/\r\n  add(obj, first) {\r\n    if (obj === undefined) {\r\n      console.log(\"[Warn] Undefined on Scene adding.\");\r\n      return;\r\n    }\r\n\r\n    if (first) {\r\n      this.objs.unshift(obj);\r\n    } else {\r\n      this.objs.push(obj);\r\n    }\r\n    if (this.camera !== undefined) {\r\n      // force camera to notify all added object refresh mvpMatrix\r\n      this.camera.update();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 添加摄像机，重复添加则会更新 camera 对象（只有一个有效）\r\n   * \r\n   * @param {*} camera \r\n   */\r\n  addCamera(camera) {\r\n    this.camera = camera;\r\n    camera.recv((matrix) => {\r\n      /**\r\n        * 通知所有物体视图矩阵有变化\r\n       **/\r\n      for (var i = 0; i < this.objs.length; i++) {\r\n        this.objs[i].onViewChanged(matrix);\r\n      }\r\n      // this.render()\r\n    });\r\n  }\r\n\r\n  /**\r\n  * 依次绘制物体\r\n  **/\r\n  render() {\r\n    this.running = true;\r\n    var scope = this;\r\n    function r() {\r\n      states.gl.clear(states.gl.COLOR_BUFFER_BIT | states.gl.DEPTH_BUFFER_BIT);   // clear color buffer and depth buffer bit\r\n      for (var i = 0; i < scope.objs.length; i++) {\r\n        scope.objs[i].paint();\r\n      }\r\n      if(scope.running) {\r\n        requestAnimationFrame(r)\r\n      }\r\n    }\r\n    requestAnimationFrame(r)\r\n    // r()\r\n    // this.render()\r\n  }\r\n\r\n\r\n  /*\r\n  * 根据渲染类型返回渲染器\r\n  * @param  gl       gl 对象\r\n  * @param  codestr  渲染程序代码，具体渲染方式\r\n  * @param  type     渲染类型\r\n  * @return  渲染器\r\n  */\r\n  getShader(gl, codestr, type) {\r\n    // 创建渲染器\r\n    var shader = gl.createShader(type);\r\n\r\n    gl.shaderSource(shader, codestr);\r\n    // 编译渲染器\r\n    gl.compileShader(shader);\r\n\r\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n      console.log(\"JS:Shader compile failed\");\r\n      console.log(gl.getShaderInfoLog(shader));\r\n      return null;\r\n    }\r\n    //    console.log(\"compile done!\");\r\n    return shader;\r\n  }\r\n\r\n  /**\r\n  * 初始化着色器\r\n  * @desc 异步加载着色器代码并在完成加载后进行编译链接\r\n  * @param {String} vertexCode\r\n  * @param {String} fragCode\r\n  **/\r\n  initShaders(vertexCode, fragCode) {\r\n    var shaderProgram = states.gl.createProgram();\r\n    var vertexShader = this.getShader(states.gl, vertexCode, states.gl.VERTEX_SHADER);\r\n    states.gl.attachShader(shaderProgram, vertexShader);\r\n\r\n    var fragShader = this.getShader(states.gl, fragCode, states.gl.FRAGMENT_SHADER);\r\n    states.gl.attachShader(shaderProgram, fragShader);\r\n    this._onShaderReady(shaderProgram);\r\n\r\n  }\r\n\r\n  /**\r\n  * 在着色器代码准备好后进行着色器的编译链接；\r\n  * 设置全局变量 attributes 和 uniforms\r\n  **/\r\n  _onShaderReady(shaderProgram) {\r\n    states.gl.linkProgram(shaderProgram);\r\n    states.gl.useProgram(shaderProgram);\r\n\r\n    attributes.vertex_position = states.gl.getAttribLocation(shaderProgram, \"aVertexPosition\");\r\n    states.gl.enableVertexAttribArray(attributes.vertex_position);\r\n\r\n    attributes.vertex_normal = states.gl.getAttribLocation(shaderProgram, \"aVertexNormal\");\r\n    states.gl.enableVertexAttribArray(attributes.vertex_normal)\r\n\r\n    attributes.color = states.gl.getAttribLocation(shaderProgram, \"aColor\");\r\n    states.gl.enableVertexAttribArray(attributes.color);\r\n\r\n    attributes.texture = states.gl.getAttribLocation(shaderProgram, \"aTexture\");\r\n    attributes.color = states.gl.getAttribLocation(shaderProgram, \"aColor\");\r\n\r\n    uniforms.pmv_matrix = states.gl.getUniformLocation(shaderProgram, \"uPMVMatrix\"); // 透视模型视图矩阵\r\n    uniforms.m_matrix = states.gl.getUniformLocation(shaderProgram, \"uMMatrix\")\r\n    uniforms.n_matrix = states.gl.getUniformLocation(shaderProgram, \"uNMatrix\"); // 法线\r\n    uniforms.alpha = states.gl.getUniformLocation(shaderProgram, \"uAlpha\");\r\n    uniforms.frag_color = states.gl.getUniformLocation(shaderProgram, \"uFragColor\");\r\n    uniforms.has_texture = states.gl.getUniformLocation(shaderProgram, \"uHasTexture\");\r\n    uniforms.light_direction = states.gl.getUniformLocation(shaderProgram, \"uLightDirection\"); // 光照\r\n    uniforms.specColor = states.gl.getUniformLocation(shaderProgram, \"uSpecColor\");\r\n    uniforms.vertexColor = states.gl.getUniformLocation(shaderProgram, \"uVertColor\");\r\n\r\n    states.gl.uniformMatrix4fv(uniforms.n_matrix, false, mat4.create());\r\n    states.gl.uniform3fv(uniforms.light_direction, this.light_direct);  // where light origins\r\n  }\r\n}\r\n\r\nexport {Camera, Scene}","import {PaintObj, cylinderShape, genVertices, coordCarte, degToRad} from './PaintObj'\r\nimport {states, attributes, uniforms} from './Variables'\r\n\r\n/**\r\n* SensorPoint Object\r\n* 在三维空间中绘制斑点，用于模拟传感器的指向。\r\n* 当指向变化时会通知注册的回调函数，以便其它对象可以得到最新的传感器位置\r\n* 尚未实现的功能：\r\n* - 从原点指向 Point 的圆锥体\r\n**/\r\nclass SensorPoint extends PaintObj {\r\n  constructor(props) {\r\n    // PaintObj.call(this, props);\r\n    super(props);\r\n    this.type = \"SensorPoint\";\r\n    // the reason why rotation and then translation is out of expections\r\n    // but if rMatrix is introduced, the result seems good\r\n    // now all vertices are calculated by function, no need for rMatrix\r\n    // this.rMatrix  = mat4.create();\r\n    this.inv_color = props.inv_color || [0.0, 1.0, 0.0];\r\n    this.dis = 4;\r\n    this.pitch = 0;\r\n    this.heading = 0;\r\n    this.headingOffset = 0;\r\n    this.roll = 0;\r\n    this.callbacks = [];\r\n    this.init();\r\n  }\r\n  \r\n  init() {\r\n    var cylinder = cylinderShape(this.size, this.sides, 0.01);\r\n\r\n    var vertex = cylinder.vertex;\r\n    var index = cylinder.index;\r\n\r\n    var i = 0;\r\n    var color = [];\r\n    for (i = 0; i <= this.sides; i++) {\r\n      color = color.concat(this.inv_color);\r\n    }\r\n    for (i = 0; i <= this.sides; i++) {\r\n      color = color.concat(this.color);\r\n    }\r\n\r\n    var vertices = genVertices(vertex, color, [0, 1, 1]);\r\n    this.index_count = index.length;\r\n\r\n    this.buffers.vertex = this.createArrayBuffer(new Float32Array(vertices), states.gl.STATIC_DRAW);\r\n    this.buffers.index = this.createArrayBuffer(new Uint16Array(index), states.gl.STATIC_DRAW);\r\n  }\r\n\r\n  paint() {\r\n    states.gl.bindBuffer(states.gl.ARRAY_BUFFER, this.buffers.vertex);\r\n    states.gl.vertexAttribPointer(attributes.vertex_position, 3, states.gl.FLOAT, false, 9 * 4, 0);\r\n    states.gl.vertexAttribPointer(attributes.color, 3, states.gl.FLOAT, false, 9 * 4, 3 * 4);\r\n    states.gl.vertexAttribPointer(attributes.vertex_normal, 3, states.gl.FLOAT, false, 9 * 4, 6 * 4);\r\n\r\n    states.gl.uniform1f(uniforms.alpha, this.alpha);          //  set alpha value\r\n\r\n    states.gl.uniformMatrix4fv(uniforms.m_matrix, false, this.mMatrix);\r\n    states.gl.uniformMatrix4fv(uniforms.pmv_matrix, false, this.mvpMatrix);\r\n\r\n    states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.buffers.index);\r\n    states.gl.drawElements(states.gl.TRIANGLES, this.index_count, states.gl.UNSIGNED_SHORT, 0);\r\n  }\r\n\r\n  onViewChanged(matrix) {\r\n    this.pvMatrix = matrix || this.pvMatrix;\r\n    mat4.mul(this.mvpMatrix, this.pvMatrix, this.mMatrix);\r\n  }\r\n\r\n  setScale(size) {\r\n    this.size = size;\r\n    vec3.set(this.vscale, size, size, size);\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param {*} r  中心点与原点的距离\r\n   * @param {*} a_theta  角度制（与Z轴正半轴的夹角）\r\n   * @param {*} a_phi    角度制（与X轴正半轴的夹角）\r\n   */\r\n  setTranslation(r, a_theta, a_phi) {\r\n    this.translation = coordCarte(degToRad(a_theta), degToRad(a_phi), r);\r\n    quat.fromEuler(this.quat, 0, a_theta, a_phi);\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * 根据给定的参数更新俯仰角，航向角，中心点与原点的距离等\r\n   * @param {*} params  \r\n   * dis  中心点与原点的距离\r\n   * pitch 俯仰角（与X轴平面的夹角，在 Z 轴正向一侧为正）\r\n   * heading 航向角（在 XOY 平面上的投影与X轴正半轴的夹角）\r\n   * roll 横滚角。对于 SensorPoint 对象来说没有作用\r\n   */\r\n  setParam(params) {\r\n\r\n    this.dis = params.dis || this.dis;\r\n    if(params.pitch) {\r\n      this.pitch = params.pitch;\r\n    }\r\n    if(params.heading) {\r\n      this.heading = params.heading;\r\n      params.heading = params.heading - this.headingOffset;\r\n    }\r\n    if(params.roll) {\r\n      this.roll = params.roll;\r\n    }\r\n    var theta = 90 - this.pitch;\r\n    this.setTranslation(this.dis, theta, this.heading);\r\n  }\r\n\r\n  /**\r\n    * 更新自身的模型视图矩阵并通知已注册的回调函数\r\n  **/\r\n  update() {\r\n    mat4.fromRotationTranslationScale(this.mMatrix,\r\n      this.quat,\r\n      this.translation,\r\n      this.vscale);\r\n    this.onViewChanged();\r\n\r\n    var spherical = this.spherical();\r\n    for (var i = 0; i < this.callbacks.length; i++) {\r\n      this.callbacks[i]({\r\n        dis: this.dis, pitch: this.pitch, heading: this.heading,\r\n        roll: this.roll, theta: spherical[0], phi: spherical[1],\r\n        size: this.size\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n    * 注册回调函数\r\n  **/\r\n  addParamCallback(cb) {\r\n    this.callbacks.push(cb);\r\n  }\r\n\r\n  /**\r\n  * @param {Number} pitch   range [-90, 90]\r\n  * @param {Number} heading range [0, 360]\r\n  * @returns {Vec3} the angle returned is in unit of rad  vec[0] and vec[1] is in unit of RAD\r\n  *  当前指向的球坐标系坐标\r\n  */\r\n  spherical() {\r\n    var u = (90 - this.pitch) / 180 * Math.PI;\r\n    var v = this.heading / 180 * Math.PI;\r\n    return vec3.fromValues(u, v, this.dis);\r\n  }\r\n\r\n  // 重置指向\r\n  reset() {\r\n    this.headingOffset += this.heading;\r\n    //        console.log( this.heading, this.headingOffset );\r\n    this.setParam({ pitch: this.pitch, heading: this.heading, roll: this.roll, dis: this.dis });\r\n  }\r\n}\r\n// end of SensorPoint prototype\r\n\r\n/**\r\n* SensorPath Object\r\n* 1. 绘制传感器的路径，由于绘制路径采用的是记录传感器位置周围点的方法。因此很可能在运行过程中出现缓冲区被用完的情况，\r\n* 会自动申请新的缓冲区，记录的点越多，需要的缓冲区越多。\r\n* 2. 每申请一次约占用 90k 的内存（或显存）。另外 js 数组中保存的数据也会占用内存，所以根据已写入缓冲区的数据量进行\r\n* 偏移，对之后的缓冲区进行写操作，不在 js 数组中保留所有的点。\r\n* 3. 18.03.03 将路径绘制成虚线的绘制方法存在问题。因此路径每隔 gap 段绘制一次并没有实现，调整 gap 不会\r\n* 影响路径的绘制。（即路径以实线形式绘制）\r\n**/\r\nclass SensorPath extends PaintObj{\r\n  MaxPathNum = 4800 * 12\r\n  constructor(props) {\r\n    super(props);\r\n    this.type = \"SensorPath\";\r\n    this.all_index_count = 0;\r\n    this.cur_path_count = 0;\r\n    this.cur_index_count = 0;\r\n    this.cur_pi = 0; // path index\r\n    this.buffer_path_bytes = this.MaxPathNum * 4; // 4 means the bytes float occupies, 3 means a point contains 3 coordinate\r\n    this.buffer_index_bytes = this.MaxPathNum * 2; // 2 means the bytes uint  occupies\r\n    this.gap = 1; // must equal or greater then 1\r\n    this.pg = 1; // path gap count\r\n    this.width = 1.0;\r\n    this.init();\r\n  }\r\n\r\n  \r\n  init() {\r\n    this.angle = this.last_point;\r\n    this.path = [];\r\n    this.index = [];\r\n\r\n    // path buffer initialization\r\n    this.buffers.path = [];\r\n    this.buffers.index = [];\r\n\r\n    this.createBuffer();\r\n  }\r\n\r\n  paint() {\r\n    if (!this.visible) {\r\n      return;\r\n    }\r\n    states.gl.uniform1f(uniforms.alpha, this.alpha);     // set alpha value\r\n    states.gl.uniformMatrix4fv(uniforms.m_matrix, false, this.mMatrix);\r\n    states.gl.uniformMatrix4fv(uniforms.pmv_matrix, false, this.mvpMatrix);\r\n\r\n    // 分批绘制路径\r\n    for (var i = 0; i < this.cur_pi; i++) {\r\n      states.gl.bindBuffer(states.gl.ARRAY_BUFFER, this.buffers.path[i]);\r\n      states.gl.vertexAttribPointer(attributes.vertex_normal, 3, states.gl.FLOAT, false, 6 * 4, 0);\r\n      states.gl.vertexAttribPointer(attributes.vertex_position, 3, states.gl.FLOAT, false, 6 * 4, 0);\r\n      states.gl.vertexAttribPointer(attributes.color, 3, states.gl.FLOAT, false, 6 * 4, 3 * 4);\r\n      states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.buffers.index[i]);\r\n      states.gl.drawElements(states.gl.TRIANGLES, this.MaxPathNum, states.gl.UNSIGNED_SHORT, 0);\r\n    }\r\n    if (this.cur_index_count > 0) {\r\n      //            console.log( this.cur_index_count );\r\n      states.gl.bindBuffer(states.gl.ARRAY_BUFFER, this.buffers.path[this.cur_pi]);\r\n      states.gl.vertexAttribPointer(attributes.vertex_normal, 3, states.gl.FLOAT, false, 6 * 4, 0);\r\n      states.gl.vertexAttribPointer(attributes.vertex_position, 3, states.gl.FLOAT, false, 6 * 4, 0);\r\n      states.gl.vertexAttribPointer(attributes.color, 3, states.gl.FLOAT, false, 6 * 4, 3 * 4);\r\n      states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.buffers.index[this.cur_pi]);\r\n      states.gl.drawElements(states.gl.TRIANGLES, this.cur_index_count, states.gl.UNSIGNED_SHORT, 0);\r\n    }\r\n  }\r\n\r\n  onViewChanged(matrix) {\r\n    this.pvMatrix = matrix || this.pvMatrix;\r\n    mat4.mul(this.mvpMatrix, this.pvMatrix, this.mMatrix);\r\n  }\r\n\r\n  /**\r\n    * @param nangle next sphericalCoord\r\n    * @param langle last sphericalCoord\r\n    */\r\n  updateBuffer(nangle) {\r\n    var langle = [this.last_point.theta, this.last_point.phi, this.last_point.dis];\r\n    var presult = this.getLinearPoint(nangle, langle);\r\n    this.all_index_count += presult.index.length;\r\n\r\n    this.subBuffer(this.buffers.path[this.cur_pi], this.cur_path_count * 4, new Float32Array(presult.vertices));\r\n    this.subBuffer(this.buffers.index[this.cur_pi], this.cur_index_count * 2, new Uint16Array(presult.index));\r\n\r\n    // Note! because the updateSubBuffer() should use the offset as the parameter,\r\n    // the addition of path or index count should be later, or the buffer will be out of its size\r\n    this.cur_path_count += presult.vertices.length;\r\n    this.cur_index_count += presult.index.length;\r\n\r\n    // when path index count is greater or equal to this.MaxPathNum, then a new buffer should be realloced\r\n    // and the counter should be reset\r\n    if (this.cur_index_count >= this.MaxPathNum) {\r\n      this.cur_pi++;\r\n      console.log(\"Info: [Path] create a new buffer!\\n\");\r\n      this.createBuffer();\r\n      this.resetCurrentPath();\r\n    }\r\n  }\r\n\r\n  setGap(gap) {\r\n    this.gap = gap;\r\n  }\r\n\r\n  setSize(size) {\r\n    this.size = size;\r\n  }\r\n\r\n  /**\r\n   * 用于绘制路径所需的顶点和索引, 每次返回 4 个顶点\r\n   * @param {Array} p     p[0] = theta    p[1] = beta    p[2] = radius\r\n   * @param {Array} lp   lp[0] = theta   lp[1] = beta   lp[2] = lradius\r\n   * @return {Object}\r\n   */\r\n  getLinearPoint(p, lp) {\r\n    var s1 = coordCarte(p[0], p[1], p[2]);\r\n    var s2 = coordCarte(lp[0], lp[1], lp[2]);\r\n    var s = [s1[0] - s2[0], s1[1] - s2[1], s1[2] - s2[2]];\r\n    //    console.log(\"s1: \"+ s1 + \"  s2: \"+s2 + \"  s: \" + s +\"\\n\");\r\n    var n0 = coordCarte((p[0] + lp[0]) * 0.5, (p[1] + lp[1]) * 0.5, p[2]);\r\n    var l = vec3.create();\r\n    vec3.cross(l, s, n0);\r\n    vec3.normalize(l, l);\r\n    vec3.scale(l, l, this.size * 0.02);\r\n    //    console.log(\"vec l: \" + vec3.str(l));\r\n\r\n    var vertex;\r\n    var vertices = [];\r\n    var that = this;\r\n\r\n    var pushVertex = function () {\r\n      vertices = vertices.concat(vertex);\r\n      vertices = vertices.concat(that.color);\r\n    }\r\n\r\n    vertex = [s1[0] - l[0], s1[1] - l[1], s1[2] - l[2]];   // 0\r\n    pushVertex();\r\n    vertex = [s1[0] + l[0], s1[1] + l[1], s1[2] + l[2]];   // 1\r\n    pushVertex();\r\n    vertex = [s2[0] - l[0], s2[1] - l[1], s2[2] - l[2]];   // 2\r\n    pushVertex();\r\n    vertex = [s2[0] + l[0], s2[1] + l[1], s2[2] + l[2]];   // 3\r\n    pushVertex();\r\n    // until now, vertices length should be 24\r\n\r\n    var index = [];\r\n    var seg = 6;\r\n    var n = this.cur_path_count / seg;  // it is better than index.length\r\n    index.push(n + 0, n + 2, n + 3, n + 0, n + 3, n + 1);\r\n    index.push(n + 0, n + 3, n + 2, n + 0, n + 1, n + 3);\r\n\r\n    return {\r\n      //            \"point\" : linearPoint,\r\n      //            \"color\" : color,\r\n      \"vertices\": vertices,\r\n      \"index\": index,\r\n    }\r\n  }\r\n\r\n  onSphericalChanged(params) {\r\n    if (this.last_point === undefined) {\r\n      this.last_point = params;\r\n      //            return;\r\n    }\r\n\r\n    var lpos = coordCarte(this.last_point.theta, this.last_point.phi, this.last_point.dis);\r\n    var pos = coordCarte(params.theta, params.phi, params.dis);\r\n    var dist = vec3.dist(lpos, pos);\r\n    var angle = [params.theta, params.phi, params.dis];\r\n\r\n    if (dist > Math.PI * params.dis * 0.002) {\r\n      this.updateBuffer(angle);\r\n      this.angle = angle;\r\n      this.last_point = params;\r\n    }\r\n\r\n    // angle[2] is vector length\r\n    //        if( dist > Math.PI * params.dis * 0.03 ) {\r\n    //            this.updateBuffer( angle );\r\n    //            this.angle      = angle;\r\n    //            this.last_point = params;\r\n    //        } else if( dist > Math.PI * params.dis * 0.001 ) {\r\n    //            this.pg ++;\r\n    //            this.last_point = params;\r\n\r\n    //            if( this.pg === this.gap ) {\r\n    //                this.angle = angle;\r\n    //            }\r\n    //            if( this.pg === this.gap+1 ) {\r\n    //                this.pg = 1;\r\n    //                this.updateBuffer( angle );\r\n    //                this.angle = angle;\r\n    //            }\r\n    //        }\r\n  }\r\n\r\n  // 重置路径变量\r\n  resetCurrentPath(vec) {\r\n    this.cur_path_count = 0;\r\n    this.cur_index_count = 0;\r\n    this.pg = 0;\r\n  }\r\n\r\n  resetAllPath(args) {\r\n    // 删掉无用的buffer，节省内存\r\n    for (var i = 1; i <= this.cur_pi; i++) {\r\n      gl.deleteBuffer(this.buffers.path[i]);\r\n      gl.deleteBuffer(this.buffers.index[i]);\r\n    }\r\n    this.all_index_count = 0;\r\n    this.cur_pi = 0;\r\n    this.last_point = undefined\r\n    this.resetCurrentPath();\r\n  }\r\n\r\n  createBuffer() {\r\n    this.buffers.path[this.cur_pi] = this.createArrayBuffer(this.buffer_path_bytes, states.gl.DYNAMIC_DRAW, states.gl.ARRAY_BUFFER);\r\n    this.buffers.index[this.cur_pi] = this.createArrayBuffer(this.buffer_index_bytes, states.gl.DYNAMIC_DRAW, states.gl.ELEMENT_ARRAY_BUFFER);\r\n  }\r\n}\r\n// end of SensorPath prototype\r\n\r\n\r\n/**\r\n* 打点操作\r\n* 初始化时为顶点申请一定大小的缓冲区，打点的数量有限制，\r\n* 因为在程序运行时不会自动申请缓冲区。\r\n**/\r\nclass RecordPoint extends PaintObj{\r\n  constructor(props) {\r\n    super(props)\r\n    this.type = \"RecordPoint\";\r\n    this.max_vertex = this.sides * 1000;\r\n    this.vertex_count = 0;\r\n    this.index_count = 0;\r\n    this.init();\r\n  }\r\n  \r\n  init () {\r\n    this.buffers.vertex = this.createArrayBuffer(this.max_vertex * 4, states.gl.DYNAMIC_DRAW, states.gl.ARRAY_BUFFER);\r\n    this.buffers.index = this.createArrayBuffer(this.max_vertex * 2, states.gl.DYNAMIC_DRAW, states.gl.ELEMENT_ARRAY_BUFFER);\r\n  }\r\n\r\n  paint () {\r\n    // 进行采点操作\r\n    if (this.vertex_count === 0 || !this.visible) {\r\n      return;\r\n    }\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.buffers.vertex);\r\n    gl.vertexAttribPointer(attributes.vertex_normal, 3, gl.FLOAT, false, 6 * 4, 0);\r\n    gl.vertexAttribPointer(attributes.vertex_position, 3, gl.FLOAT, false, 6 * 4, 0);\r\n    gl.vertexAttribPointer(attributes.color, 3, gl.FLOAT, false, 6 * 4, 3 * 4);\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffers.index);\r\n\r\n    gl.uniform1f(uniforms.alpha, this.alpha);\r\n    gl.uniformMatrix4fv(uniforms.m_matrix, false, this.mMatrix);\r\n    gl.uniformMatrix4fv(uniforms.pmv_matrix, false, this.mvpMatrix);\r\n    gl.drawElements(gl.TRIANGLES, this.index_count, gl.UNSIGNED_SHORT, 0);\r\n  }\r\n\r\n  onViewChanged (matrix) {\r\n    this.pvMatrix = matrix || this.pvMatrix;\r\n    mat4.mul(this.mvpMatrix, this.pvMatrix, this.mMatrix);\r\n  }\r\n\r\n  setSize (size) {\r\n    this.size = size;\r\n    vec3.fromValues(this.vscale, size, size, size);\r\n    mat4.fromRotationTranslationScale(this.mMatrix, this.quat, this.translation, this.vscale);\r\n    this.onViewChanged();\r\n  }\r\n\r\n  record () {\r\n    if (!this.visible) {\r\n      return;\r\n    }\r\n\r\n    console.log(\"[Info]: record a point.\");\r\n\r\n    var i = 0, j = 0;\r\n    var point = [];\r\n    var index = [];\r\n\r\n    point = circleShape(this.size, this.sides, 0, Math.PI * 2);\r\n    rotateVertex(point, this.theta, this.phi, this.dis);\r\n\r\n    var vertices = genVertices(point, [0.0, 0.5, 0.5]);\r\n\r\n    var n = this.vertex_count / 6;\r\n    for (i = 1; i < this.sides; i++) {\r\n      index.push(n, n + i, n + i + 1,\r\n        n, n + i + 1, n + i\r\n      );\r\n    }\r\n    index.push(n, n + this.sides, n + 1,\r\n      n, n + 1, n + this.sides\r\n    );\r\n    this.subBuffer(this.buffers.vertex, this.vertex_count * 4, new Float32Array(vertices));\r\n    this.subBuffer(this.buffers.index, this.index_count * 2, new Uint16Array(index));\r\n\r\n    this.vertex_count += vertices.length;\r\n    this.index_count += index.length;\r\n  }\r\n\r\n  onSphericalChanged (params) {\r\n    this.theta = params.theta;\r\n    this.phi = params.phi;\r\n    this.dis = params.dis * 1.01;\r\n    this.size = params.size * 0.95;\r\n  }\r\n\r\n  // 重置已经打的点\r\n  reset () {\r\n    this.vertex_count = 0;\r\n    this.index_count = 0;\r\n  }\r\n}\r\n// end of RecordPoint prototype\r\n\r\nexport {SensorPoint, SensorPath, RecordPoint};","\r\n\r\n/**\r\n* 飞行器模拟器，模型是从 https://archive3d.net/ 中下载的，\r\n* 模型转换成 OBJ 格式，并利用 [webgl-obj-loader](https://github.com/frenchtoast747/webgl-obj-loader)\r\n* 进行加载\r\n**/\r\nclass Craft {\r\n  constructor(props) {\r\n    PaintObj.call(this);\r\n    this.type = \"Craft\";\r\n    this.url = \"qrc:/res/obj/craft.obj\";\r\n    var scale = props.size || 1;\r\n    this.setScale(scale);\r\n    this.init();\r\n  }\r\n  init() {\r\n    var that = this;\r\n    readFile(this.url, function (text) {\r\n      that.mesh = new ObjLoader.OBJ.Mesh(text);\r\n      ObjLoader.OBJ.initMeshBuffers(gl, that.mesh);\r\n    });\r\n  }\r\n\r\n  paint() {\r\n\r\n    if (this.mesh === undefined || !this.visible) {\r\n      return;\r\n    }\r\n\r\n    gl.uniform1f(uniforms.alpha, this.alpha);\r\n    //        gl.uniform3fv( uniforms.frag_color, [0.8, 0.3, 0.6] );\r\n    //        gl.uniform1i(  uniforms.has_texture, true );\r\n    gl.uniform1i(uniforms.specColor, 1);\r\n    gl.uniform3fv(uniforms.vertexColor, this.color);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.mesh.vertexBuffer);\r\n    gl.vertexAttribPointer(attributes.vertex_position, this.mesh.vertexBuffer.itemSize, gl.FLOAT, false, 0, 0);\r\n\r\n    //        if(!this.mesh.textures.length){\r\n    //            gl.disableVertexAttribArray(attributes.textureCoordAttribute);\r\n    //        }\r\n    //        else{\r\n    //            // if the texture vertexAttribArray has been previously\r\n    //            // disabled, then it needs to be re-enabled\r\n    //            gl.enableVertexAttribArray( attributes.texture );\r\n    //            gl.bindBuffer( gl.ARRAY_BUFFER, this.mesh.textureBuffer );\r\n    //            gl.vertexAttribPointer( attributes.texture, this.mesh.textureBuffer.itemSize, gl.FLOAT, false, 0, 0);\r\n    //        }\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.mesh.normalBuffer);\r\n    gl.vertexAttribPointer(attributes.vertex_normal, this.mesh.normalBuffer.itemSize, gl.FLOAT, false, 0, 0);\r\n\r\n    gl.uniformMatrix4fv(uniforms.m_matrix, false, this.mMatrix);\r\n    gl.uniformMatrix4fv(uniforms.pmv_matrix, false, this.mvpMatrix);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.mesh.indexBuffer);\r\n    gl.drawElements(gl.TRIANGLES, this.mesh.indexBuffer.numItems, gl.UNSIGNED_SHORT, 0);\r\n\r\n    //        gl.uniform1i( uniforms.has_texture, false );\r\n    gl.uniform1i(uniforms.specColor, false);\r\n  }\r\n\r\n  onViewChanged(matrix) {\r\n    this.pvMatrix = matrix || this.pvMatrix;\r\n    mat4.mul(this.mvpMatrix, this.pvMatrix, this.mMatrix);\r\n  }\r\n\r\n  /**\r\n    * 加载模型不进行旋转操作时，可以看到模型指向 Z 轴负半轴，模型顶部指向 Y 轴\r\n    * 正半轴，因此需要在跟随 SensorPoint 做旋转操作时需要首先调整指向。\r\n    * mat4.rotate 方法会将物体的坐标轴进行旋转，即旋转后物体坐标轴与世界坐标系的轴不同\r\n  **/\r\n  setRotation(params) {\r\n    this.pitch = params.pitch;\r\n    this.heading = params.heading;\r\n    this.roll = params.roll;\r\n    //        quat4.fromEuler( this.quat, params.heading, params.pitch, params.roll );\r\n    mat4.fromScaling(this.mMatrix, this.vscale);\r\n    // if craft's look at [1, 0, 0] and its up is [0, 0, 1]\r\n    // following rotation will be fine, now it needs to some calibrations\r\n    // what's more, the coordinate will rotate with the angle\r\n    //        mat4.rotateZ( this.mMatrix, this.mMatrix, degToRad( params.heading ) );\r\n    //        mat4.rotateY( this.mMatrix, this.mMatrix, degToRad( params.pitch ) );\r\n    //        mat4.rotateX( this.mMatrix, this.mMatrix, degToRad( params.roll ) );\r\n\r\n    mat4.rotateX(this.mMatrix, this.mMatrix, degToRad(90));\r\n    //        mat4.rotateY( this.mMatrix, this.mMatrix, degToRad( 270 ) );\r\n    mat4.rotateY(this.mMatrix, this.mMatrix, degToRad(params.heading + 270));\r\n    mat4.rotateX(this.mMatrix, this.mMatrix, degToRad(params.pitch));\r\n    mat4.rotateZ(this.mMatrix, this.mMatrix, degToRad(params.roll));\r\n    this.onViewChanged();\r\n  }\r\n\r\n  setScale(size) {\r\n    this.size = size;\r\n    vec3.set(this.vscale, size, size, size);\r\n    sensorPoint.update();\r\n    //        this.setRotation( {} );\r\n  }\r\n}\r\n\r\nexport {Craft};","import {PaintObj, degToRad, coordCarte, circleShape, genVertices} from './PaintObj'\r\nimport {states, uniforms, attributes} from './Variables'\r\n/**\r\n* Sphere Object\r\n* 绘制参考球。绘制模式有 1. 球面 2. 线条 3.少数线条 等模式\r\n**/\r\nclass Sphere extends PaintObj{\r\n  constructor(props) {\r\n    super(props);\r\n    this.type = \"Sphere\";\r\n    this.vn = props.vn || 48;\r\n    this.hn = (props.hn || 48) * 0.5;\r\n    this.ratio = 0.25;\r\n    this.size = 4; // default radius\r\n    this.drawMode = Sphere.MODE_SURFACE;\r\n    this.line_alpha = 0.65;\r\n    this.alpha = 0.25;\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    var res = this.getVertex();\r\n    var index = this.getIndex();\r\n\r\n    // vertex info，static_draw is enough for both vertex and index now\r\n    this.vertexBuffer = this.createArrayBuffer(new Float32Array(res.vertices), states.gl.STATIC_DRAW);\r\n    this.indexBuffer = this.createArrayBuffer(new Uint16Array(index.vertex_index), states.gl.STATIC_DRAW);\r\n    this.lineIndexBuffer = this.createArrayBuffer(new Uint16Array(index.line_index), states.gl.STATIC_DRAW);\r\n    this.lessLineIndexBuffer = this.createArrayBuffer(new Uint16Array(index.less_line_index), states.gl.STATIC_DRAW);\r\n    this.lessLSIndexBuffer = this.createArrayBuffer(new Uint16Array(index.less_ls_index), states.gl.STATIC_DRAW);\r\n  }\r\n\r\n\r\n  paint() {\r\n    states.gl.bindBuffer(states.gl.ARRAY_BUFFER, this.vertexBuffer);\r\n    states.gl.vertexAttribPointer(attributes.vertex_position, 3, states.gl.FLOAT, false, 6 * 4, 0);\r\n    states.gl.vertexAttribPointer(attributes.vertex_normal, 3, states.gl.FLOAT, false, 6 * 4, 0);\r\n    states.gl.vertexAttribPointer(attributes.color, 3, states.gl.FLOAT, false, 6 * 4, 3 * 4);\r\n\r\n    states.gl.uniformMatrix4fv(uniforms.m_matrix, false, this.mMatrix);\r\n    states.gl.uniformMatrix4fv(uniforms.pmv_matrix, false, this.mvpMatrix);\r\n    switch (this.drawMode) {\r\n      case Sphere.MODE_LINE:\r\n        states.gl.uniform1f(uniforms.alpha, this.line_alpha);          //  set alpha value\r\n        states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.lineIndexBuffer);\r\n        states.gl.drawElements(states.gl.LINES, this.lineIndexBuffer.numItems, states.gl.UNSIGNED_SHORT, 0);\r\n        break;\r\n      case Sphere.MODE_LESSLINE:\r\n        states.gl.uniform1f(uniforms.alpha, this.line_alpha);          //  set alpha value\r\n        states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.lessLineIndexBuffer);\r\n        states.gl.drawElements(states.gl.LINES, this.lessLineIndexBuffer.numItems, states.gl.UNSIGNED_SHORT, 0);\r\n        // the surface on which equator lies\r\n        states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.lessLSIndexBuffer);\r\n        states.gl.drawElements(states.gl.TRIANGLES, this.lessLSIndexBuffer.numItems, states.gl.UNSIGNED_SHORT, 0);\r\n        break;\r\n      case Sphere.MODE_SURFACE:\r\n      default:\r\n        states.gl.uniform1f(uniforms.alpha, this.alpha);\r\n        states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n        states.gl.drawElements(states.gl.TRIANGLES, this.indexBuffer.numItems, states.gl.UNSIGNED_SHORT, 0);\r\n        break;\r\n    }\r\n  }\r\n\r\n  onViewChanged(matrix) {\r\n    this.pvMatrix = matrix || this.pvMatrix;\r\n    mat4.mul(this.mvpMatrix, this.pvMatrix, this.mMatrix);\r\n  }\r\n\r\n  setSize(size) {\r\n    this.size = size * this.ratio;\r\n    vec3.set(this.vscale, this.size, this.size, this.size);\r\n    mat4.fromScaling(this.mMatrix, this.vscale);\r\n    this.onViewChanged();\r\n  }\r\n\r\n  setDrawMode(mode) {\r\n    this.drawMode = mode;\r\n  }\r\n\r\n  setAlpha(alpha) {\r\n    this.alpha = alpha;\r\n  }\r\n\r\n  /**\r\n   * 计算得到球面的所有顶点的位置\r\n   * 先绘制经线，后绘制纬线\r\n   * @returns 返回所有类型的顶点个数\r\n   */\r\n  getVertex() {\r\n    var vertices = [];\r\n    var vertex = [];\r\n    //    var vn = [];        // 顶点法向量数组，当球心在原点时，与顶点坐标相同\r\n    var i, j, k;\r\n\r\n    // i indicates vertical line while j indicates horizontal line,\r\n    // vertical line is half a circle, so the number should be 1 more\r\n    for (j = 0; j <= this.vn; j++) {\r\n      for (i = 0; i <= this.hn; i++) {\r\n        // (n+1)*n points are needed\r\n        k = coordCarte(degToRad(i * 180 / this.hn), degToRad(j * 360 / this.vn), this.size);\r\n        vertex = vertex.concat(k[0], k[1], k[2]);\r\n      }\r\n    }\r\n    // add origin point into array\r\n    vertex = vertex.concat([0, 0, 0]);\r\n    vertices = genVertices(vertex, this.color);\r\n\r\n    return {\r\n      \"vertices\": vertices\r\n    }\r\n  }\r\n\r\n  // 获取绘制球面时需要的顶点索引\r\n  getIndex() {\r\n    var vertexIndex = []; // surfaceDrawMode  绘制时所用的索引\r\n    var lineIndex = []; // lineDrawMode     绘制时所用的索引\r\n    var lessLineIndex = []; // lessLineDrawMode 绘制时所用的索引\r\n    var lessLSIndex = [];\r\n    var i = 0, j = 0;\r\n\r\n    for (j = 0; j < this.vn; j++) {  // the last half circle (j = 0) overlaps the first one (j = 0)\r\n      for (i = 0; i < this.hn + 1; i++) {\r\n        // for line mode index\r\n        lineIndex.push(\r\n          i + j * (this.hn + 1),\r\n          i + 1 + j * (this.hn + 1),\r\n          i + j * (this.hn + 1),\r\n          i + (j + 1) * (this.hn + 1)\r\n        );\r\n\r\n        // for surface mode index\r\n        vertexIndex.push(\r\n          i + j * (this.hn + 1),        // 0\r\n          i + 1 + j * (this.hn + 1),      // 1\r\n          i + 1 + (j + 1) * (this.hn + 1)   // n+1\r\n        );\r\n        vertexIndex.push(\r\n          i + j * (this.hn + 1),            // 0\r\n          i + 1 + (j + 1) * (this.hn + 1),      // n+1\r\n          i + (j + 1) * (this.hn + 1)         // n\r\n        );\r\n      }\r\n    }\r\n    for (i = 0; i < this.hn + 1; i++) {\r\n      // 绘出 4 条经线\r\n      j = 0;\r\n      lessLineIndex.push(i + j * (this.hn + 1), i + 1 + j * (this.hn + 1));\r\n      j = 0.25 * this.vn;\r\n      lessLineIndex.push(i + j * (this.hn + 1), i + 1 + j * (this.hn + 1));\r\n      j = 0.5 * this.vn;\r\n      lessLineIndex.push(i + j * (this.hn + 1), i + 1 + j * (this.hn + 1));\r\n      j = 0.75 * this.vn;\r\n      lessLineIndex.push(i + j * (this.hn + 1), i + 1 + j * (this.hn + 1));\r\n    }\r\n    for (j = 0; j < this.vn; j++) {\r\n      i = this.hn / 2;\r\n      lessLineIndex.push(i + j * (this.hn + 1), i + (j + 1) * (this.hn + 1)); // equator line\r\n    }\r\n    // 赤道所在平面\r\n    for (j = this.vn * 0.5; j < this.vn * 0.75; j++) {\r\n      // 原点 -- 赤道上的点 -- 赤道上的点\r\n      lessLSIndex.push((this.vn + 1) * (this.hn + 1));   // origin point\r\n      lessLSIndex.push(this.hn * 0.5 + j * (this.hn + 1));\r\n      lessLSIndex.push(this.hn * 0.5 + (j + 1) * (this.hn + 1));\r\n      lessLSIndex.push((this.vn + 1) * (this.hn + 1));   // origin point\r\n      lessLSIndex.push(this.hn * 0.5 + (j + 1) * (this.hn + 1));\r\n      lessLSIndex.push(this.hn * 0.5 + j * (this.hn + 1));\r\n    }\r\n\r\n    //        this.vertex_index = vertexIndex;\r\n    //        this.line_index   = lineIndex;\r\n    //        this.less_line_index = lessLineIndex;\r\n    //        this.less_ls_index   = lessLSIndex;\r\n    return {\r\n      vertex_index: vertexIndex,\r\n      line_index: lineIndex,\r\n      less_line_index: lessLineIndex,\r\n      less_ls_index: lessLSIndex\r\n    }\r\n  }\r\n}\r\n\r\nSphere.MODE_SURFACE = 0;\r\nSphere.MODE_LINE = 1;\r\nSphere.MODE_LESSLINE = 2;\r\n// end of Sphere prototype\r\n\r\n\r\n/**\r\n* ReferenceCircle Object (球面上的参考圆圈)\r\n* 通过该对象管理分离的 26 个不同的 circle。但为了节省内存占用和\r\n* 减少绑定的缓冲区的次数，实际上只存储了一个 Circle 的 buffer，\r\n* 利用模型变换矩阵绘制出 26 个圆圈。\r\n**/\r\nclass RefCircle extends PaintObj{\r\n  constructor(props) {\r\n    super(props);\r\n    this.dis = props.dis || 4;\r\n    this.visible = false;\r\n    var circles = [];\r\n    var red = [1.0, 0.0, 0.0];\r\n    var green = [0.0, 1.0, 0.0];\r\n    var blue = [0.0, 0.0, 1.0];\r\n    var i = 0, j = 0, k = 0;\r\n    circles[k] = new ReferCircle({ \"pos\": [0, 0, this.dis], color: green, gl: states.gl });\r\n    k++;\r\n    for (i = 0; i <= 2; i++) {\r\n      for (j = 0; j < 8; j++) {\r\n        if (i === 1 && j % 2 === 0) {\r\n          circles[k] = new ReferCircle({ \"pos\": [(i + 1) * 45, j * 45, this.dis], color: green, gl: states.gl });\r\n        }\r\n        else {\r\n          circles[k] = new ReferCircle({ \"pos\": [(i + 1) * 45, j * 45, this.dis], color: blue, gl: states.gl });\r\n        }\r\n        k++;\r\n      }\r\n    }\r\n    circles[k] = new ReferCircle({ \"pos\": [4 * 45, 0, this.dis], color: green, gl: states.gl });\r\n    this.circles = circles;\r\n    this.setScale(props.size || 1);\r\n    this.init();\r\n  }\r\n\r\n  \r\n  init() {\r\n    var initSize = 1;\r\n    var vertex = circleShape(initSize, this.sides, 0, Math.PI * 2);\r\n    var vertices = genVertices(vertex, this.color, vertex);\r\n\r\n    var i = 0;\r\n    var index = [];\r\n    for (i = 1; i < this.sides + 1; i++) {\r\n      index.push(i);\r\n    }\r\n    this.vertexBuffer = this.createArrayBuffer(new Float32Array(vertices), states.gl.STATIC_DRAW);\r\n    this.indexBuffer = this.createArrayBuffer(new Uint16Array(index), states.gl.STATIC_DRAW);\r\n  }\r\n\r\n  paint() {\r\n    if (!this.visible) {\r\n      return;\r\n    }\r\n    states.gl.uniform1f(uniforms.alpha, this.alpha);\r\n    states.gl.uniform1i(uniforms.specColor, 1);\r\n\r\n    states.gl.bindBuffer(states.gl.ARRAY_BUFFER, this.vertexBuffer);\r\n    states.gl.vertexAttribPointer(attributes.vertex_position, 3, states.gl.FLOAT, false, 9 * 4, 0);\r\n    states.gl.vertexAttribPointer(attributes.vertex_normal, 3, states.gl.FLOAT, false, 9 * 4, 3 * 4);\r\n    states.gl.vertexAttribPointer(attributes.color, 3, states.gl.FLOAT, false, 9 * 4, 6 * 4);\r\n\r\n    states.gl.bindBuffer(states.gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n\r\n    for (var i = 0; i < 26; i++) {\r\n      //            this.circles[i].paint();\r\n      //        states.gl.uniformMatrix4fv( uniforms.m_matrix, false, this.mMatrix );\r\n      states.gl.uniform3fv(uniforms.vertexColor, this.circles[i].color);\r\n      states.gl.uniformMatrix4fv(uniforms.pmv_matrix, false, this.circles[i].mvpMatrix);\r\n      states.gl.drawElements(this.circles[i].drawMode, this.sides, states.gl.UNSIGNED_SHORT, 0);\r\n    }\r\n    states.gl.uniform1i(uniforms.specColor, 0);\r\n  }\r\n\r\n  onViewChanged(matrix) {\r\n    for (var i = 0; i < 26; i++) {\r\n      this.circles[i].onViewChanged(matrix);\r\n    }\r\n  }\r\n\r\n  setDis(dis) {\r\n    this.dis = dis;\r\n    for (var i = 0; i < 26; i++) {\r\n      this.circles[i].setTranslation(this.dis + 0.1);\r\n    }\r\n  }\r\n\r\n  setScale(size) {\r\n    //        this.size = size;\r\n    for (var i = 0; i < 26; i++) {\r\n      this.circles[i].setScale(size);\r\n    }\r\n  }\r\n\r\n  onSphericalChanged(params) {\r\n    for (var i = 0; i < 26; i++) {\r\n      //            this.circles[i].current = false;\r\n      this.circles[i].isCurrent(params);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n/**\r\n* 参考圆圈\r\n* 为节省内存和提高性能，该类不再存储圆圈的顶点缓冲区。\r\n* 实际上该类存储的只是每个圆圈的位置等信息。\r\n* 在 SensorPoint 移动时检测 SensorPoint 是否与当前圆圈相近，\r\n* 若距离很近则会改变绘制方式。\r\n**/\r\nclass ReferCircle extends PaintObj{\r\n  constructor(props) {\r\n    super(props);\r\n    this.type = \"RCircle\";\r\n    if (props.pos !== undefined) {\r\n      this.setTranslation(props.pos[2], degToRad(props.pos[0]), degToRad(props.pos[1]));\r\n      this.setQuat(props.pos[0], props.pos[1]);\r\n    }\r\n    this.current = false;\r\n    this.drawMode = states.gl.LINES;\r\n    //    this.init();\r\n  }\r\n  \r\n  onViewChanged(matrix) {\r\n    this.pvMatrix = matrix || this.pvMatrix;\r\n    mat4.fromRotationTranslationScale(this.mMatrix, this.quat, this.translation, this.vscale);\r\n    mat4.mul(this.mvpMatrix, this.pvMatrix, this.mMatrix);\r\n  }\r\n\r\n  setTranslation(r, theta, phi) {\r\n    if (theta !== undefined) {\r\n      this.theta = theta;\r\n    }\r\n\r\n    if (phi !== undefined) {\r\n      this.phi = phi;\r\n    }\r\n\r\n    this.translation = coordCarte(this.theta, this.phi, r);\r\n    this.onViewChanged();\r\n  }\r\n\r\n  setQuat(a_theta, a_phi, a_beta) {\r\n    quat.fromEuler(this.quat, 0, a_theta, a_phi);\r\n    this.onViewChanged();\r\n  }\r\n\r\n  setScale(size) {\r\n    this.size = size;\r\n    this.vscale = vec3.fromValues(size, size, size);\r\n    this.onViewChanged();\r\n  }\r\n\r\n  // 判断 Sensor point 是否接近该圆圈。（目前只考虑 theta 和 phi 角而不是计算两个圆心的距离）\r\n  isCurrent(spherical) {\r\n    if (Math.abs(spherical.theta - this.theta) < Math.PI * 0.02\r\n      && Math.abs(spherical.phi - this.phi) < Math.PI * 0.02) {\r\n      this.current = true;\r\n      var size = spherical.size * 1.15;\r\n      vec3.set(this.vscale, size, size, size);\r\n      this.originColor = new Float32Array(this.color);\r\n      this.color = [1.0, 0.0, 0.0];\r\n      this.drawMode = states.gl.LINE_LOOP;\r\n    } else if (this.current) {\r\n      this.current = false;\r\n      vec3.set(this.vscale, this.size, this.size, this.size);\r\n      this.color = this.originColor;\r\n      this.drawMode = states.gl.LINES;\r\n    }\r\n    this.onViewChanged();\r\n  }\r\n}\r\n// end of ReferCircle prototype\r\n\r\nexport {Sphere, RefCircle};","/**\r\n * Author: BriFuture\r\n * update: 2019/03/27\r\n * Description: [Compass](https://github.com/BriFuture/Compass) 是这个程序的 QML 版本，\r\n * 利用 webpack 的打包功能重写了核心的 JS 绘图程序。\r\n * \r\n * License: GPLv3\r\n * Note: 默认 glMatrix 已加载，并且 mat4, vec3 可以直接使用，否则程序运行会出错\r\n */\r\n/* 保存画布上下文 */\r\nexport const version = \"0.0.01\";\r\n\r\nimport {states} from './Variables'\r\nvar gl2d;  // this is used for HUD drawing\r\n//var nMatrix   = mat4.create();\r\nimport Coord from './Coord'\r\nimport { Camera, Scene } from './Scene'\r\nimport { SensorPoint, SensorPath, RecordPoint } from './SensorPoint'\r\nimport { Craft } from './Craft'\r\nimport {Sphere, RefCircle} from './Sphere'\r\n// const fs = require('fs')\r\n\r\nimport vertexCode from '!raw-loader!../assets/SPVertexCode.vsh'\r\nimport fragCode from '!raw-loader!../assets/SPFragCode.fsh'\r\nvar canvasArgs; // 相关绘图变量\r\nvar gl;\r\n\r\nexport class SpacePath {\r\n  constructor(canvas) {\r\n    gl  = canvas.getContext(\"webgl\",\r\n      { depth: true, antilias: true }\r\n    );\r\n    states.gl = gl;\r\n    // console.log(vertexCode)\r\n    var scene = new Scene({gl});\r\n    this.scene = scene;\r\n    scene.initShaders(vertexCode, fragCode)\r\n    this.camera = new Camera({height: 600, width: 800});\r\n    scene.addCamera(this.camera)\r\n    \r\n    this.coord = new Coord({gl});\r\n    scene.add(this.coord);\r\n\r\n    var sensorPoint = new SensorPoint({gl, color: [1.0, 0.2, 0.1]});\r\n    // sensorPoint.setParam({dis: 3, pitch: 0, heading: 0});\r\n    this.sensorPoint = sensorPoint;\r\n    scene.add(sensorPoint);\r\n    var sensorPath = new SensorPath({gl});\r\n    this.sensorPath = sensorPath;\r\n    scene.add(this.sensorPath);\r\n    this.sphere = new Sphere({gl});\r\n    scene.add(this.sphere);\r\n    var recordPoint = new RecordPoint({gl});\r\n    this.recordPoint = recordPoint;\r\n    \r\n    scene.add(this.recordPoint);\r\n    var refCircle = new RefCircle({gl});\r\n    this.refCircle = refCircle;\r\n    scene.add(this.refCircle);\r\n    sensorPoint.addParamCallback(function( params ) {\r\n      sensorPath.onSphericalChanged( params );\r\n      recordPoint.onSphericalChanged(params);\r\n      refCircle.onSphericalChanged( params );\r\n      // craft.setRotation( params );\r\n    });\r\n    // this.craft = craft;\r\n    scene.render()\r\n    // return;\r\n  }\r\n\r\n  reset() {\r\n    sensorPoint.reset();\r\n    sensorPath.resetAllPath();\r\n    camera.reset();\r\n  }\r\n\r\n  addRefCircle(props) {\r\n    if (refCircle === undefined) {\r\n      refCircle = new RefCircle(props);\r\n      sensorPoint.addParamCallback(function (params) {\r\n        refCircle.onSphericalChanged(params);\r\n      });\r\n      sensorPoint.update();\r\n      scene.add(refCircle, true);\r\n    }\r\n  }\r\n\r\n  addCraft(props) {\r\n    if (craft === undefined) {\r\n      craft = new Craft(props);\r\n      sensorPoint.addParamCallback(function (params) {\r\n        craft.setRotation(params);\r\n      });\r\n      sensorPoint.update();\r\n      scene.add(craft, true);\r\n    }\r\n  }\r\n\r\n  initializeGL(canvas, args) {\r\n    gl = canvas.getContext(\"canvas3d\",\r\n      { depth: true, antilias: true }\r\n    );\r\n    gl2d = canvas.getContext(\"2d\");\r\n\r\n    scene = new Scene();\r\n    camera = new Camera();\r\n    coordinate = new Coord();\r\n    sensorPoint = new SensorPoint({ color: [0.9, 0.2, 0.15] });\r\n    sensorPoint.setScale(0.1);\r\n    sensorPath = new SensorPath({ color: [0.9, 0.5, 0.2], size: 0.3 });\r\n    sensorPoint.addParamCallback(function (params) {\r\n      sensorPath.onSphericalChanged(params);\r\n    });\r\n\r\n    recordPoint = new RecordPoint();\r\n\r\n    sensorPoint.addParamCallback(function (params) {\r\n      recordPoint.onSphericalChanged(params);\r\n    });\r\n    sphere = new Ball({\r\n      color: [0.95, 0.2, 0.2],\r\n      vn: 48,\r\n      hn: 48\r\n    });\r\n\r\n    sensorPoint.setParam({ dis: 4, pitch: 0, roll: 0, heading: 0 });\r\n\r\n    /** 开始执行实际的绘图操作，由于开启了 ALPHA BLEND 功能，先绘制球内物体 **/\r\n    scene.add(coordinate);\r\n    scene.add(sensorPoint);\r\n    scene.add(sensorPath);\r\n    scene.add(recordPoint);\r\n    scene.add(sphere);\r\n    scene.add(camera);\r\n  }\r\n\r\n  paintGL(canvas) {\r\n    var pixelRatio = canvas.devicePixelRatio;\r\n    var currentWidth = canvas.width * pixelRatio;\r\n    var currentHeight = canvas.height * pixelRatio;\r\n\r\n    if (currentWidth !== camera.width || currentHeight !== camera.height) {\r\n      camera.setSize(currentWidth, currentHeight);\r\n    }\r\n    scene.render();\r\n  }\r\n\r\n  resizeGL(canvas) {\r\n    var pixelRatio = canvas.devicePixelRatio;\r\n    canvas.pixelSize = Qt.size(canvas.width * pixelRatio, canvas.height * pixelRatio);\r\n  }\r\n}\r\n\r\n\r\n/** Test: to watch variables change **/\r\nclass Test {\r\n  constructor() {\r\n    this._x = 0;\r\n    this._y = 0;\r\n    this._z = 0;\r\n  }\r\n}\r\n\r\n/**\r\n* this function is copied from planets demo of qt version of threejs\r\n* I modified some of it, now it works fine for me\r\n**/\r\nfunction readFile(url, onLoad, onProgress, onError) {\r\n  var request = new XMLHttpRequest();\r\n\r\n  request.onreadystatechange = function () {\r\n    if (request.readyState === XMLHttpRequest.DONE) {\r\n      // TODO: Re-visit https://bugreports.qt.io/browse/QTBUG-45581 is solved in Qt\r\n      if (request.status == 200 || request.status == 0) {\r\n        //                var response;\r\n        // TODO: Remove once https://bugreports.qt.io/browse/QTBUG-45862 is fixed in Qt\r\n        //                response = request.responseText;\r\n\r\n        console.time('Process file: \"' + url + '\"');\r\n        onLoad(request.responseText);\r\n        console.timeEnd('Process file: \"' + url + '\"');\r\n\r\n      }\r\n      //              else if ( onError !== undefined ) {\r\n      //                onError();\r\n      //            }\r\n    }\r\n    //        else if (request.readyState === XMLHttpRequest.HEADERS_RECEIVED) {\r\n    //            if ( onProgress !== undefined ) {\r\n    //                onProgress();\r\n    //            }\r\n    //        }\r\n  };\r\n\r\n  request.open('GET', url, true);\r\n  request.send(null);\r\n}\r\nwindow.SpacePath = SpacePath;\r\nexport default { SpacePath }","export default \"precision mediump float;\\r\\n\\r\\nattribute vec3 aVertexPosition;\\r\\nattribute vec3 aVertexNormal;\\r\\nattribute vec2 aTexture;\\r\\nattribute vec3 aColor;\\r\\n\\r\\nuniform mat4 uPMVMatrix;\\r\\nuniform mat4 uMMatrix;\\r\\nuniform mat4 uNMatrix;\\r\\nuniform vec3 uVertColor;\\r\\nuniform bool uSpecColor;\\r\\n\\r\\nuniform vec3  uLightDirection; // 直射光的方向\\r\\nvarying vec3  vLight;\\r\\nvarying vec2  vTexture;\\r\\nvarying vec3  vNormal;\\r\\nvarying vec3  vPosition;\\r\\n\\r\\n\\r\\nvoid main(void) {\\r\\n    gl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0);\\r\\n\\r\\n    vec3 normal = normalize( vec3( uNMatrix * vec4( aVertexNormal, 1 ) ) );\\r\\n    vNormal = normal;\\r\\n    vPosition = vec3( uMMatrix * vec4( aVertexPosition , 1.0 ) );\\r\\n\\r\\n//    vec3 ambientLight     = vec3( 0.2, 0.24, 0.21 );\\r\\n//    vec3 directLightColor = vec3( 0.75, 0.75, 0.75 );\\r\\n//    float directional = max( dot( normal, normalize( uLightDirection ) ), 0.0);\\r\\n//    vec3 diffuse = directLightColor * directional;\\r\\n\\r\\n    if( !uSpecColor ) {\\r\\n//        vLight = aColor * (ambientLight + diffuse);\\r\\n        vLight = aColor;\\r\\n    } else {\\r\\n//        vLight = uVertColor * (ambientLight + diffuse);\\r\\n        vLight = uVertColor;\\r\\n    }\\r\\n    vTexture = aTexture;\\r\\n}\\r\\n\"","export default \"precision mediump float;\\r\\n\\r\\nvarying vec3  vLight;\\r\\nvarying vec2  vTexture;\\r\\nvarying vec3  vNormal;\\r\\nvarying vec3  vPosition;\\r\\n\\r\\nuniform float uAlpha;\\r\\nuniform vec3 uFragColor;\\r\\nuniform bool uHasTexture;\\r\\nuniform sampler2D uSampler;\\r\\n\\r\\n// uniform sampler2D uYSampler;\\r\\n// uniform sampler2D uZSampler;\\r\\n// uniform int uEnableTexture;\\r\\nvoid main(void) {\\r\\n    vec3 lightPos = vec3( 10, 10, 10 );\\r\\n    vec3 ambientLight = vec3( 0.28, 0.28, 0.28 );\\r\\n    vec3 directLightColor = vec3( 0.88, 0.88, 0.88 );\\r\\n    float directional = max( dot( normalize( vNormal ), normalize( lightPos - vPosition ) ), 0.0);        // 直接使用顶点的法线数据进行漫反射计算\\r\\n    vec3 diffuse = directLightColor * directional;\\r\\n\\r\\n    if( uHasTexture ) {\\r\\n//        vec4 color = mix( uFragColor, texture2D( uSampler, vec2( vTexture.s, vTexture.t ) ), 0.5 );\\r\\n        gl_FragColor = vec4( uFragColor * (diffuse + ambientLight), uAlpha );\\r\\n    }\\r\\n    else {\\r\\n        gl_FragColor = vec4( vLight * (diffuse + ambientLight), uAlpha );\\r\\n    }\\r\\n//   mediump vec4 xtextureColor = texture2D(uXSampler, vec2(vXTexture.s, vXTexture.t));\\r\\n//   mediump vec4 ytextureColor = texture2D(uYSampler, vec2(vXTexture.s, vXTexture.t));\\r\\n//   mediump vec4 ztextureColor = texture2D(uZSampler, vec2(vXTexture.s, vXTexture.t));\\r\\n//   if( uEnableTexture == 0 ) {\\r\\n//     gl_FragColor = vec4(vLight, uAlpha);\\r\\n//   }\\r\\n//   else if( uEnableTexture == 1 ) {\\r\\n//     gl_FragColor = vec4(vLight, 1.0) * xtextureColor;\\r\\n//   }\\r\\n//   else if( uEnableTexture == 2 ) {\\r\\n//     gl_FragColor = vec4(vLight, 1.0) * ytextureColor;}\\r\\n//   else if( uEnableTexture == 3 ) {\\r\\n//     gl_FragColor = vec4(vLight, 1.0) * ztextureColor;\\r\\n//   }\\r\\n}\\r\\n\"","<template>\r\n  <b-container fluid id=\"app\">\r\n    <!-- <script type=\"text/javascript\" src=\"@/components/gl-matrix-min.js\"></script> -->\r\n    <b-row>\r\n      <b-col cols=\"2\" class=\"\">\r\n        <c-sidebar :camera=\"camera\"\r\n        ></c-sidebar>\r\n        <c-information></c-information>\r\n      </b-col>\r\n      <b-col cols=\"10\">\r\n        <canvas ref=\"canvas\" width=\"800\" height=\"600\"></canvas>\r\n      </b-col>\r\n      <b-col cols=\"3\">\r\n        <c-debug-panel @valueChanged=\"debugValueChanged($event)\"></c-debug-panel>\r\n      </b-col>\r\n    </b-row>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport CSidebar from './components/Sidebar.vue'\r\nimport CInformation from './components/Information.vue'\r\nimport CDebugPanel from './components/DebugPanel.vue'\r\nimport {SpacePath} from './compass/SpacePath'\r\n\r\nexport default {\r\n  name: 'app',\r\n  components: {\r\n    CSidebar,\r\n    CInformation,\r\n    CDebugPanel\r\n  },\r\n  data() {\r\n    return {\r\n      camera: {},\r\n      // spacepath: {}\r\n    }\r\n  },\r\n  created() {\r\n    // console.log(this.$refs)\r\n    // this.sp = new SpacePath()\r\n  },\r\n  mounted() {\r\n    console.log(\"Mounted\")\r\n    this.spacepath = new SpacePath(this.$refs.canvas)\r\n    this.camera = this.spacepath.camera;\r\n  },\r\n  methods: {\r\n    debugValueChanged(event) {\r\n      if(event.key == \"heading\") {\r\n        this.spacepath.sensorPoint.setParam({heading: parseFloat(event.value)})\r\n      } else if(event.key == \"pitch\") {\r\n        this.spacepath.sensorPoint.setParam({pitch: parseFloat(event.value)})\r\n      } else if(event.key == \"roll\") {\r\n        this.spacepath.sensorPoint.setParam({roll: parseFloat(event.value)})\r\n      }\r\n      // console.log(event);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n#app {\r\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  text-align: center;\r\n  color: #2c3e50;\r\n  margin-top: 60px;\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=2bb3bc52&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport BootstrapVue from 'bootstrap-vue'\r\nimport 'bootstrap/dist/css/bootstrap.css'\r\nimport 'bootstrap-vue/dist/bootstrap-vue.css'\r\n\r\nVue.use(BootstrapVue)\r\n\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  render: h => h(App),\r\n}).$mount('#app')\r\n"],"sourceRoot":""}